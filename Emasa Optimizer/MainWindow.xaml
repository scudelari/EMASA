<Window
    x:Class="Emasa_Optimizer.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ap="clr-namespace:BaseWPFLibrary.AttachedProperties;assembly=BaseWPFLibrary"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:e="clr-namespace:BaseWPFLibrary;assembly=BaseWPFLibrary"
    xmlns:eb="clr-namespace:BaseWPFLibrary.Bindings;assembly=BaseWPFLibrary"
    xmlns:ec="clr-namespace:BaseWPFLibrary.Converters;assembly=BaseWPFLibrary"
    xmlns:ev="clr-namespace:BaseWPFLibrary.ValidationRules;assembly=BaseWPFLibrary"
    xmlns:fea="clr-namespace:Emasa_Optimizer.FEA"
    xmlns:h="clr-namespace:Emasa_Optimizer.WpfResources"
    xmlns:local="clr-namespace:Emasa_Optimizer"
    xmlns:localParamDefinitions="clr-namespace:Emasa_Optimizer.Opt.ParamDefinitions"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:nupdown="clr-namespace:NumericUpDownLib;assembly=NumericUpDownLib"
    xmlns:opt="clr-namespace:Emasa_Optimizer.Opt"
    xmlns:system="clr-namespace:System;assembly=mscorlib"
    Title="Emasa Geometry Optimizer"
    Width="1500"
    Height="950"
    Initialized="Window_Initialized"
    ResizeMode="NoResize"
    UseLayoutRounding="True"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="WpfResources/GeneralTemplates.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <ec:InverseBooleanConverter x:Key="InverseBooleanConverter" />
            <h:WpfImageCaptureViewDirectionEnumFlagsValueConverter x:Key="ImageValConv" />
        </ResourceDictionary>
    </Window.Resources>
    <Grid x:Name="MainGrid">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <GroupBox Header="Grasshopper Algorithm" Style="{StaticResource Blue_GroupBox}">
                <Grid SnapsToDevicePixels="True">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Border
                        Margin="20,0"
                        HorizontalAlignment="Stretch"
                        SnapsToDevicePixels="True"
                        Style="{StaticResource BottomOnly_Border}">
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontFamily="Courier New"
                            FontSize="20"
                            Text="{Binding Gh_Alg.WpfGrasshopperName, Mode=OneWay, FallbackValue='Grasshopper File Name'}" />
                    </Border>
                    <TextBlock
                        Grid.Row="1"
                        Margin="20,5,20,0"
                        HorizontalAlignment="Stretch"
                        FontFamily="Courier New"
                        Style="{StaticResource Explanation_TextBlock}"
                        Text="{Binding Gh_Alg.WpfGrasshopperFileDescription, Mode=OneWay, FallbackValue='Grasshopper Description'}"
                        TextAlignment="Center"
                        TextWrapping="Wrap" />
                </Grid>
            </GroupBox>
            <Grid Grid.Row="1" Grid.Column="0">
                <TabControl TabStripPlacement="Top">
                    <TabItem Header="Definitions">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <GroupBox
                                Grid.Row="0"
                                Grid.Column="0"
                                Grid.ColumnSpan="2"
                                Header="Grasshopper Non-Linear Optimization Parameters"
                                IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                Style="{StaticResource Blue_GroupBox}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Style="{StaticResource ListBoxHeaderGrid}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="1.5*" />
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="2*" />
                                            <ColumnDefinition Width="{StaticResource VerticalScrollBarWidth}" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Margin="0,0,0,0">
                                            <TextBlock TextDecorations="underline">
                                                <Run FontWeight="Bold" Text="Name" />
                                                <Run Text=" and " />
                                                <Run FontStyle="Italic" Text="Type" />
                                            </TextBlock>
                                        </Label>
                                        <Label Grid.Column="1">
                                            <TextBlock TextDecorations="underline">Search Range</TextBlock>
                                        </Label>
                                        <Label Grid.Column="2">
                                            <TextBlock TextDecorations="underline">Search Start Position</TextBlock>
                                        </Label>
                                        <Label Grid.Column="3" BorderThickness="0,1,0,1" />
                                    </Grid>
                                    <ItemsControl
                                        x:Name="GhNonLinearParameter_Setup_ListBox"
                                        Grid.Row="1"
                                        IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                        ItemTemplateSelector="{StaticResource GhNonLinearParameter_Setup_ListBox_TemplateSelector}"
                                        ItemsSource="{Binding Gh_Alg.InputDefs_View}"
                                        Style="{StaticResource VirtualItemsControl}" />
                                </Grid>
                            </GroupBox>
                            <GroupBox
                                Grid.Row="0"
                                Grid.Column="2"
                                Grid.ColumnSpan="2"
                                Header="Grasshopper Output Geometry"
                                IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                Style="{StaticResource Blue_GroupBox}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Style="{StaticResource ListBoxHeaderGrid}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="{StaticResource VerticalScrollBarWidth}" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Margin="0,0,0,0">
                                            <TextBlock TextDecorations="underline">
                                                <Run FontWeight="Bold" Text="Name" />
                                                <Run Text=" and " />
                                                <Run FontStyle="Italic" Text="Type" />
                                            </TextBlock>
                                        </Label>
                                        <Label Grid.Column="1">
                                            <TextBlock TextDecorations="underline">Restraints</TextBlock>
                                        </Label>
                                        <Label Grid.Column="2" BorderThickness="0,1,0,1" />
                                    </Grid>
                                    <ItemsControl
                                        x:Name="GhOutputGeometry_Setup_ListBox"
                                        Grid.Row="1"
                                        ItemTemplate="{StaticResource GhOutputGeometry_Setup_ListBox_ItemTemplate_IghElement_HasRestraint_Edit}"
                                        ItemsSource="{Binding Gh_Alg.GeometryDefs_PointLineListBundle_View}"
                                        Style="{StaticResource VirtualItemsControl}" />
                                </Grid>
                            </GroupBox>
                            <GroupBox
                                Grid.Row="1"
                                Grid.Column="0"
                                Header="Finite Element Options"
                                IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                Style="{StaticResource Blue_GroupBox}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto " />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <GroupBox
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Margin="0"
                                        Header="Finite Element Optimizer"
                                        Style="{StaticResource CenterHeader_GroupBox}">
                                        <ComboBox
                                            Height="20"
                                            Margin="20,0"
                                            DisplayMemberPath="Value"
                                            ItemsSource="{Binding FeOpt.WfpCaption_FeSolverTypeEnum}"
                                            SelectedValue="{Binding FeOpt.FeSolverType_Selected}"
                                            SelectedValuePath="Key" />
                                    </GroupBox>
                                    <GroupBox
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Margin="0"
                                        Header="EV Blk Capture Modes"
                                        Style="{StaticResource CenterHeader_GroupBox}"
                                        Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                        <nupdown:UIntegerUpDown
                                            MaxValue="20"
                                            MinValue="1"
                                            ToolTip="The number of Eigenvalue Buckling Modes that will be captured.&#x0a;This has to be larger than the mode selected as imperfect shape.&#x0a;Ideally, it should be at least 3 modes higher than desired (FE Optimizer Precision)."
                                            Value="{Binding FeOpt.EigenvalueBuckling_ShapesToCapture}" />
                                    </GroupBox>
                                    <GroupBox
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        Margin="0"
                                        Header="Loads"
                                        Style="{StaticResource CenterHeader_GroupBox}"
                                        Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                        <GroupBox>
                                            <GroupBox.Header>
                                                <CheckBox Content="Gravity" IsChecked="{Binding FeOpt.Gravity_IsLoad}" />
                                            </GroupBox.Header>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="5" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="20" />
                                                    <RowDefinition Height="5" />
                                                    <RowDefinition Height="20" />
                                                </Grid.RowDefinitions>
                                                <TextBlock
                                                    Grid.Row="0"
                                                    Grid.Column="0"
                                                    Text="Direction:" />
                                                <ComboBox
                                                    Grid.Row="0"
                                                    Grid.Column="2"
                                                    DisplayMemberPath="Value"
                                                    ItemsSource="{Binding FeOpt.WfpCaption_MainAxisDirectionEnum}"
                                                    SelectedValue="{Binding FeOpt.Gravity_DirectionEnum_Selected}"
                                                    SelectedValuePath="Key"
                                                    ToolTip="Direction of the Gravity Load Application.&#x0a;Note: this is applied as inertial loading, thus the orientation of the force is inverted." />
                                                <TextBlock
                                                    Grid.Row="2"
                                                    Grid.Column="0"
                                                    Text="Multiplier:"
                                                    ToolTip="Multiplier applied to the standard gravity." />
                                                <TextBox
                                                    Grid.Row="2"
                                                    Grid.Column="2"
                                                    h:DepObjs.CancelErrorOnLostFocus="true"
                                                    Text="{Binding FeOpt.Gravity_Multiplier, ValidatesOnExceptions=True}" />
                                            </Grid>
                                        </GroupBox>
                                    </GroupBox>
                                    <GroupBox
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        Margin="0"
                                        Header="Imperfect Shape"
                                        Style="{StaticResource CenterHeader_GroupBox}"
                                        Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="5" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="20" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="5" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="5" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="EV Blk Mode:" />
                                            <nupdown:UIntegerUpDown
                                                Grid.Column="2"
                                                MaxValue="20"
                                                MinValue="1"
                                                ToolTip="The Eigenvalue Buckling Mode whose deflection will be used as imperfect shape."
                                                Value="{Binding FeOpt.Imperfect_EigenvalueBucklingMode}" />
                                            <TextBlock
                                                Grid.Column="4"
                                                VerticalAlignment="Center"
                                                Text="Mult:"
                                                ToolTip="Multiplier to scale the deformations from the selected Eigenvalue Buckling Mode." />
                                            <TextBox
                                                Grid.Column="6"
                                                Height="20"
                                                h:DepObjs.CancelErrorOnLostFocus="true"
                                                IsEnabled="{Binding FeOpt.Imperfect_MultiplierFromBoundingBox, Converter={StaticResource InverseBooleanConverter}}"
                                                Text="{Binding FeOpt.Imperfect_Multiplier, ValidatesOnExceptions=True}" />
                                            <CheckBox
                                                Grid.Column="8"
                                                VerticalAlignment="Center"
                                                Content="BB/1000"
                                                IsChecked="{Binding FeOpt.Imperfect_MultiplierFromBoundingBox}"
                                                ToolTip="Use the largest length of the model's Bounding Box, divided by 1000, as multiplier." />
                                        </Grid>

                                    </GroupBox>
                                    <GroupBox
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        Margin="0"
                                        Header="Mesh Elements Per Frame"
                                        Style="{StaticResource CenterHeader_GroupBox}"
                                        Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                        <nupdown:UIntegerUpDown
                                            MaxValue="10"
                                            MinValue="1"
                                            ToolTip="The number of mesh elements per frame."
                                            Value="{Binding FeOpt.Mesh_ElementsPerFrame}" />
                                    </GroupBox>
                                    <GroupBox
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Margin="0"
                                        Header="Large Deflections"
                                        Style="{StaticResource CenterHeader_GroupBox}"
                                        Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                        <CheckBox
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Content="Use Large Deflections"
                                            IsChecked="{Binding FeOpt.LargeDeflections_IsSet}"
                                            ToolTip="Calculate the Non-Linear models using large deflections (update stiffness matrix with each Finite Element iteration)." />
                                    </GroupBox>
                                </Grid>
                            </GroupBox>
                            <GroupBox
                                Grid.Row="2"
                                Grid.Column="0"
                                Header="ScreenShot Options"
                                IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                Style="{StaticResource Blue_GroupBox}">
                                <StackPanel>
                                    <GroupBox Header="Directions">
                                        <StackPanel Orientation="Vertical">
                                            <StackPanel.Resources>
                                                <Style TargetType="CheckBox">
                                                    <Setter Property="Margin" Value="0,0,5,0" />
                                                </Style>
                                            </StackPanel.Resources>
                                            <TextBlock HorizontalAlignment="Center" Text="Axial" />
                                            <Border
                                                HorizontalAlignment="Center"
                                                BorderBrush="{StaticResource EmsLightGraySolidBrush}"
                                                BorderThickness="0,1,0,0">
                                                <WrapPanel Margin="5,2,5,5">
                                                    <CheckBox Content="Top" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Top_Towards_ZNeg}}" />
                                                    <CheckBox Content="Front" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Front_Towards_YPos}}" />
                                                    <CheckBox Content="Back" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Back_Towards_YNeg}}" />
                                                    <CheckBox Content="Left" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Left_Towards_XPos}}" />
                                                    <CheckBox Content="Right" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Right_Towards_XNeg}}" />
                                                </WrapPanel>
                                            </Border>
                                            <TextBlock HorizontalAlignment="Center" Text="Edges" />
                                            <Border
                                                HorizontalAlignment="Center"
                                                BorderBrush="{StaticResource EmsLightGraySolidBrush}"
                                                BorderThickness="0,1,0,0">
                                                <WrapPanel Margin="5,2,5,5">
                                                    <CheckBox Content="Top-Front" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_Top_Front_Edge}}" />
                                                    <CheckBox Content="Top-Back" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_Top_Back_Edge}}" />
                                                    <CheckBox Content="Top-Left" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_Top_Left_Edge}}" />
                                                    <CheckBox Content="Top-Right" IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_Top_Right_Edge}}" />
                                                </WrapPanel>
                                            </Border>
                                            <TextBlock HorizontalAlignment="Center" Text="Corners" />
                                            <Border
                                                HorizontalAlignment="Center"
                                                BorderBrush="{StaticResource EmsLightGraySolidBrush}"
                                                BorderThickness="0,1,0,0">
                                                <Grid Margin="5,2">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                    </Grid.RowDefinitions>
                                                    <CheckBox
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Content="Top-Front-Left"
                                                        IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_TFL_Corner}}" />
                                                    <CheckBox
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Content="Top-Front-Right"
                                                        IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_TFR_Corner}}" />
                                                    <CheckBox
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Content="Top-Back-Left"
                                                        IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_TBL_Corner}}" />
                                                    <CheckBox
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Content="Top-Back-Right"
                                                        IsChecked="{Binding ScreenShotOpt.ImageCapture_ViewDirections, Converter={StaticResource ImageValConv}, ConverterParameter={x:Static opt:ImageCaptureViewDirectionEnum.Perspective_TBR_Corner}}" />
                                                </Grid>
                                            </Border>
                                        </StackPanel>
                                    </GroupBox>
                                    <Grid Margin="0,5" Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="5" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="15" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="5" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Text="Extrude Factor"
                                            ToolTip="The factor to multiply the extrusion of the sections.&#x0a;No extrusion (lines).&#x0a;Original section size." />
                                        <TextBox
                                            Grid.Row="0"
                                            Grid.Column="2"
                                            h:DepObjs.CancelErrorOnLostFocus="true"
                                            Text="{Binding ScreenShotOpt.ImageCapture_Extrude_Multiplier, ValidatesOnExceptions=True}" />
                                        <CheckBox
                                            Grid.Row="0"
                                            Grid.Column="4"
                                            VerticalAlignment="Center"
                                            Content="Plot on Deformed"
                                            IsChecked="{Binding ScreenShotOpt.ImageCapture_DeformedShape}"
                                            ToolTip="Plot on deformed shape (for supported plots).&#x0a;Multiplied by 5% of the model's largest edge of the bounding box." />
                                        <CheckBox
                                            Grid.Row="0"
                                            Grid.Column="6"
                                            VerticalAlignment="Center"
                                            Content="Undef. Shadow"
                                            IsChecked="{Binding ScreenShotOpt.ImageCapture_UndeformedShadow}"
                                            ToolTip="Plot a shadow of the undeformed shape (for supported plots)." />
                                    </Grid>
                                </StackPanel>

                            </GroupBox>
                            <GroupBox
                                Grid.Row="1"
                                Grid.RowSpan="2"
                                Grid.Column="1"
                                Grid.ColumnSpan="3"
                                Header="Finite Element Result Selection"
                                IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                Style="{StaticResource Blue_GroupBox}"
                                Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                <ItemsControl
                                    x:Name="FeOptions_ResultSelection_ListBox"
                                    ItemsSource="{Binding FeOpt.Wpf_AllResultsForInterface.Groups}"
                                    Style="{StaticResource VirtualItemsControl}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <GroupBox Style="{StaticResource CenterHeader_GroupBox}">
                                                <GroupBox.Header>
                                                    <TextBlock x:Name="Shape_TextBlock">
                                                        <!--  The "Name" here is of the Shape - type FeAnalysisShapeEnum  -->
                                                        <Run FontSize="16" Text="{Binding Path=Name, Mode=OneWay, Converter={StaticResource Wpf_EnumToString_Converter}, ConverterParameter=Item2}" />
                                                        <Run Foreground="{StaticResource EmsExplanationSolidBrush}" Text=" [" />
                                                        <Run Foreground="{StaticResource EmsExplanationSolidBrush}" Text="{Binding Mode=OneWay, Converter={StaticResource Wpf_FeResultClassificationTreeViewCounter_Converter}}" />
                                                        <Run Foreground="{StaticResource EmsExplanationSolidBrush}" Text="]" />
                                                    </TextBlock>
                                                </GroupBox.Header>
                                                <!--  Second List View - Grouping by Result Family  -->
                                                <ItemsControl ItemsSource="{Binding Items}">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <WrapPanel HorizontalAlignment="Center" />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <DockPanel
                                                                    Width="100"
                                                                    Margin="5"
                                                                    LastChildFill="True">
                                                                    <Border
                                                                        HorizontalAlignment="Stretch"
                                                                        BorderBrush="{StaticResource EmsFaintBlueSolidBrush}"
                                                                        BorderThickness="0,0,0,1"
                                                                        DockPanel.Dock="Top">

                                                                        <Button
                                                                            VerticalAlignment="Center"
                                                                            VerticalContentAlignment="Center"
                                                                            Click="{eb:MethodBinding {Binding ElementName=MainGrid, Path=DataContext.FeOpt},
                                                                                                     SelectOrDeselect_AllResultsInShapeFamily,
                                                                                                     {Binding Path=Name},
                                                                                                     {Binding ElementName=Shape_TextBlock, Path=DataContext.Name}}"
                                                                            Content="{Binding Path=Name, Mode=OneWay, Converter={StaticResource Wpf_EnumToString_Converter}, ConverterParameter=Item1}"
                                                                            Style="{x:Null}"
                                                                            Template="{StaticResource FiniteElementResultSelectionCategoryButtonContentTemplate}"
                                                                            ToolTip="{Binding Path=Name, Mode=OneWay, Converter={StaticResource Wpf_EnumToString_Converter}, ConverterParameter=Item2}" />

                                                                    </Border>

                                                                    <Border
                                                                        Padding="5,5,0,0"
                                                                        HorizontalAlignment="Stretch"
                                                                        BorderBrush="{StaticResource EmsFaintBlueSolidBrush}"
                                                                        BorderThickness="1,0,0,0">
                                                                        <ItemsControl
                                                                            ItemsSource="{Binding Items}"
                                                                            ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                            Style="{StaticResource VirtualItemsControl}">
                                                                            <ItemsControl.ItemTemplate>
                                                                                <DataTemplate>
                                                                                    <CheckBox
                                                                                        Content="{Binding ResultType, Mode=OneWay, Converter={StaticResource Wpf_EnumToString_Converter}, ConverterParameter=Item1}"
                                                                                        IsChecked="{Binding OutputData_IsSelected}"
                                                                                        ToolTip="{Binding Wpf_Explanation}" />
                                                                                </DataTemplate>
                                                                            </ItemsControl.ItemTemplate>
                                                                        </ItemsControl>
                                                                    </Border>
                                                                </DockPanel>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </GroupBox>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </GroupBox>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Optimize">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="400" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <GroupBox
                                Header="Configurations"
                                IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                Style="{StaticResource Blue_GroupBox}">
                                <Grid Grid.Row="0" Grid.Column="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <GroupBox
                                        Grid.Column="0"
                                        Header="Sections"
                                        Style="{StaticResource CenterHeader_GroupBox}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="10" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <GroupBox Grid.Column="0">
                                                <GroupBox.Header>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock
                                                            Margin="0,0,5,0"
                                                            VerticalAlignment="Center"
                                                            Text="Available Sections" />
                                                        <Button
                                                            Grid.Column="1"
                                                            Width="22"
                                                            Height="22"
                                                            Margin="2,0"
                                                            Background="{StaticResource EmsPanelBackground_Gray}"
                                                            Click="{eb:MethodBinding {Binding PcOpt},
                                                                                     Wpf_FeSections_SelectAll}"
                                                            ToolTip="Select ALL sections.">
                                                            <Button.Content>
                                                                <TextBlock FontFamily="Segoe UI Symbol" Text="✲" />
                                                            </Button.Content>
                                                        </Button>
                                                        <Button
                                                            Grid.Column="2"
                                                            Width="22"
                                                            Height="22"
                                                            Margin="2,0"
                                                            Background="{StaticResource EmsPanelBackground_Gray}"
                                                            Click="{eb:MethodBinding {Binding PcOpt},
                                                                                     Wpf_FeSections_ClearSelection}"
                                                            ToolTip="Clear selection.">
                                                            <Button.Content>
                                                                <TextBlock FontFamily="Segoe UI Symbol" Text="" />
                                                            </Button.Content>
                                                        </Button>
                                                        <Button
                                                            Grid.Column="3"
                                                            Width="22"
                                                            Height="22"
                                                            Margin="2,0"
                                                            Background="{StaticResource EmsPanelBackground_Gray}"
                                                            Click="{eb:MethodBinding {Binding PcOpt},
                                                                                     Wpf_FeSections_SelectCenterOfEachFamily}"
                                                            ToolTip="Select center of each family.">
                                                            <Button.Content>
                                                                <TextBlock FontFamily="Segoe UI Symbol" Text="" />
                                                            </Button.Content>
                                                        </Button>
                                                    </Grid>
                                                </GroupBox.Header>
                                                <ListBox
                                                    x:Name="PcOpt_AvailableSections_Selection_ListBox"
                                                    Margin="0,5,0,0"
                                                    ec:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding PcOpt.WpfSelected_Sections}"
                                                    ItemContainerStyle="{StaticResource ListBoxContainerStyle}"
                                                    ItemsSource="{Binding PcOpt.AvailableSectionList_View}"
                                                    SelectionMode="Extended"
                                                    Style="{StaticResource VirtualListBox_VerticalScrollOptional}">
                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Style="{StaticResource NumberTextBlock}" Text="{Binding NameFixed, Mode=OneWay}" />
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                </ListBox>
                                            </GroupBox>
                                            <GroupBox Grid.Column="2" Header="Grasshopper Line Lists">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition />
                                                        <RowDefinition Height="120" />
                                                    </Grid.RowDefinitions>
                                                    <ListBox
                                                        x:Name="PcOpt_GhLineListSections_ListBox"
                                                        Grid.Row="0"
                                                        ItemContainerStyle="{StaticResource ListBoxContainerStyle}"
                                                        ItemTemplate="{StaticResource PcOpt_GhLineListSections_ListBox_ItemTemplate_GhLineList}"
                                                        ItemsSource="{Binding Gh_Alg.GeometryDefs_LineList_View}"
                                                        SelectedItem="{Binding PcOpt.CurrentlySelectedLineListForDetails}"
                                                        SelectionMode="Single"
                                                        Style="{StaticResource VirtualListBox_VerticalScrollOptional}" />
                                                    <GroupBox Grid.Row="1" Style="{StaticResource CenterHeader_GroupBox}">
                                                        <GroupBox.Header>
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto" />
                                                                    <ColumnDefinition Width="5" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="{Binding PcOpt.CurrentlySelectedLineListForDetails.Name, FallbackValue='', Mode=OneWay}" />
                                                                <TextBlock Grid.Column="2" Text="details" />
                                                            </Grid>
                                                        </GroupBox.Header>
                                                        <ListBox
                                                            x:Name="PcOpt_GhLineListSections_Details_ListBox"
                                                            ItemContainerStyle="{StaticResource ListBoxContainerStyle}"
                                                            ItemsSource="{Binding PcOpt.CurrentlySelectedLineListForDetails.WpfFeSections_ToCombine}"
                                                            SelectionMode="Single"
                                                            Style="{StaticResource VirtualListBox_VerticalScrollOptional}">
                                                            <ListBox.ItemTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding NameFixed}" />
                                                                </DataTemplate>
                                                            </ListBox.ItemTemplate>
                                                        </ListBox>
                                                    </GroupBox>
                                                </Grid>
                                            </GroupBox>
                                        </Grid>
                                    </GroupBox>
                                    <Border
                                        Grid.Column="1"
                                        HorizontalAlignment="Center"
                                        BorderBrush="{StaticResource EmsDarkBlueSolidBrush}"
                                        BorderThickness="1,0,0,0" />
                                    <GroupBox
                                        Grid.Column="2"
                                        Header="Grasshopper Integers"
                                        Style="{StaticResource CenterHeader_GroupBox}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="10" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <GroupBox Grid.Column="0">
                                                <GroupBox.Header>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock
                                                            Margin="0,0,5,0"
                                                            VerticalAlignment="Center"
                                                            Text="Available Integers" />
                                                        <Button
                                                            Grid.Column="1"
                                                            Width="22"
                                                            Height="22"
                                                            Margin="2,0"
                                                            Background="{StaticResource EmsPanelBackground_Gray}"
                                                            Click="{eb:MethodBinding {Binding PcOpt},
                                                                                     Wpf_Integers_SelectAll}"
                                                            ToolTip="Select ALL integers in the list.">
                                                            <Button.Content>
                                                                <TextBlock FontFamily="Segoe UI Symbol" Text="✲" />
                                                            </Button.Content>
                                                        </Button>
                                                        <Button
                                                            Grid.Column="2"
                                                            Width="22"
                                                            Height="22"
                                                            Margin="2,0"
                                                            Background="{StaticResource EmsPanelBackground_Gray}"
                                                            Click="{eb:MethodBinding {Binding PcOpt},
                                                                                     Wpf_Integers_ClearSelection}"
                                                            ToolTip="Clear selection.">
                                                            <Button.Content>
                                                                <TextBlock FontFamily="Segoe UI Symbol" Text="" />
                                                            </Button.Content>
                                                        </Button>
                                                        <Button
                                                            Grid.Column="3"
                                                            Width="22"
                                                            Height="22"
                                                            Margin="2,0"
                                                            Background="{StaticResource EmsPanelBackground_Gray}"
                                                            Click="{eb:MethodBinding {Binding PcOpt},
                                                                                     wpf_Integers_SelectOdd}"
                                                            ToolTip="Select ODD integers.">
                                                            <Button.Content>
                                                                <TextBlock Text="O" />
                                                            </Button.Content>
                                                        </Button>
                                                        <Button
                                                            Grid.Column="4"
                                                            Width="22"
                                                            Height="22"
                                                            Margin="2,0"
                                                            Background="{StaticResource EmsPanelBackground_Gray}"
                                                            Click="{eb:MethodBinding {Binding PcOpt},
                                                                                     wpf_Integers_SelectEven}"
                                                            ToolTip="Select EVEN integers.">
                                                            <Button.Content>
                                                                <TextBlock Text="E" />
                                                            </Button.Content>
                                                        </Button>
                                                    </Grid>
                                                </GroupBox.Header>
                                                <Grid Margin="0,5,0,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="5" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="10" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="5" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="5" />
                                                        <RowDefinition />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        VerticalAlignment="Center"
                                                        Text="Min" />
                                                    <TextBox
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Text="{Binding PcOpt.RangeMin, ValidatesOnExceptions=True}" />
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="4"
                                                        VerticalAlignment="Center"
                                                        Text="Max" />
                                                    <TextBox
                                                        Grid.Row="0"
                                                        Grid.Column="6"
                                                        Text="{Binding PcOpt.RangeMax, ValidatesOnExceptions=True}" />
                                                    <ListBox
                                                        x:Name="PcOpt_AvailableIntegers_Selection_ListBox"
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Grid.ColumnSpan="7"
                                                        ec:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding PcOpt.WpfSelected_Integers}"
                                                        ItemContainerStyle="{StaticResource ListBoxContainerStyle}"
                                                        ItemsSource="{Binding PcOpt.AvailableIntegerList_View}"
                                                        SelectionMode="Extended"
                                                        Style="{StaticResource VirtualListBox_VerticalScrollOptional}">
                                                        <ListBox.ItemTemplate>
                                                            <DataTemplate>
                                                                <TextBlock
                                                                    Margin="2"
                                                                    Style="{StaticResource NumberTextBlock}"
                                                                    Text="{Binding}" />
                                                            </DataTemplate>
                                                        </ListBox.ItemTemplate>
                                                    </ListBox>
                                                </Grid>
                                            </GroupBox>
                                            <GroupBox Grid.Column="2" Header="Grasshopper Integer Inputs">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition />
                                                        <RowDefinition Height="120" />
                                                    </Grid.RowDefinitions>
                                                    <ListBox
                                                        x:Name="PcOpt_GhIntegerConfigInputs_ListBox"
                                                        Grid.Row="0"
                                                        ItemContainerStyle="{StaticResource ListBoxContainerStyle}"
                                                        ItemTemplate="{StaticResource PcOpt_GhIntegerConfigInputs_ListBox_ItemTemplate_GhIntegerConfig}"
                                                        ItemsSource="{Binding Gh_Alg.ConfigDefs_Integer_View}"
                                                        SelectedItem="{Binding PcOpt.CurrentlySelectedIntegerConfigForDetails}"
                                                        SelectionMode="Single"
                                                        Style="{StaticResource VirtualListBox_VerticalScrollOptional}" />
                                                    <GroupBox Grid.Row="1" Style="{StaticResource CenterHeader_GroupBox}">
                                                        <GroupBox.Header>
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto" />
                                                                    <ColumnDefinition Width="5" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="{Binding PcOpt.CurrentlySelectedIntegerConfigForDetails.Name, FallbackValue='', Mode=OneWay}" />
                                                                <TextBlock Grid.Column="2" Text="details" />
                                                            </Grid>
                                                        </GroupBox.Header>
                                                        <ListBox
                                                            x:Name="PcOpt_GhIntegerConfigInts_Details_ListBox"
                                                            ItemContainerStyle="{StaticResource ListBoxContainerStyle}"
                                                            ItemsSource="{Binding PcOpt.CurrentlySelectedIntegerConfigForDetails.WpfIntegers_ToCombine}"
                                                            SelectionMode="Single"
                                                            Style="{StaticResource VirtualListBox_VerticalScrollOptional}" />
                                                    </GroupBox>
                                                </Grid>
                                            </GroupBox>
                                        </Grid>
                                    </GroupBox>

                                </Grid>
                            </GroupBox>
                            <GroupBox
                                Grid.Row="1"
                                Grid.Column="0"
                                Header="Quantity Management"
                                Style="{StaticResource Blue_GroupBox}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="5" />
                                        <ColumnDefinition Width="2*" />
                                    </Grid.ColumnDefinitions>
                                    <GroupBox Grid.Column="0" IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}">
                                        <GroupBox.Header>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock
                                                    Margin="0,0,5,0"
                                                    VerticalAlignment="Center"
                                                    Text="Available Quantities" />
                                                <Button
                                                    Grid.Column="3"
                                                    Width="22"
                                                    Height="22"
                                                    Margin="2,0"
                                                    Background="{StaticResource EmsPanelBackground_Green}"
                                                    Click="{eb:MethodBinding {Binding ProbQuantMgn},
                                                                             AddAllProblemQuantity_FunctionObjective}"
                                                    DockPanel.Dock="Right"
                                                    ToolTip="Add ALL quantities as a variable of the Objective Function.">
                                                    <Button.Content>
                                                        <TextBlock FontFamily="Segoe UI Symbol" Text="◉" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                                    Grid.Column="2"
                                                    Width="22"
                                                    Height="22"
                                                    Margin="2,0"
                                                    Background="{StaticResource EmsPanelBackground_Yellow}"
                                                    Click="{eb:MethodBinding {Binding ProbQuantMgn},
                                                                             AddAllProblemQuantity_ConstraintObjective}"
                                                    DockPanel.Dock="Right"
                                                    ToolTip="Add ALL quantities as a constraint variable.">
                                                    <Button.Content>
                                                        <TextBlock FontFamily="Segoe UI Symbol" Text="⛓" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                                    Grid.Column="1"
                                                    Width="22"
                                                    Height="22"
                                                    Margin="2,0"
                                                    Background="{StaticResource EmsPanelBackground_Gray}"
                                                    Click="{eb:MethodBinding {Binding ProbQuantMgn},
                                                                             AddAllProblemQuantity_OutputOnly}"
                                                    DockPanel.Dock="Right"
                                                    ToolTip="Add ALL quantities as output only.">
                                                    <Button.Content>
                                                        <TextBlock FontFamily="Segoe UI Symbol" Text="" />
                                                    </Button.Content>
                                                </Button>
                                            </Grid>
                                        </GroupBox.Header>
                                        <ScrollViewer>
                                            <StackPanel
                                                Orientation="Vertical"
                                                ScrollViewer.CanContentScroll="True"
                                                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                                ScrollViewer.VerticalScrollBarVisibility="Visible">
                                                <GroupBox Header="Grasshopper Geometry" Style="{StaticResource CenterHeader_GroupBox}">
                                                    <ItemsControl
                                                        x:Name="ProbQuantMgn_AvailableQuantities_GhDoubleList_Selection_ListBox"
                                                        ItemsSource="{Binding Gh_Alg.GeometryDefs_DoubleList_View}"
                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                        Style="{StaticResource VirtualItemsControl}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <DockPanel LastChildFill="True">
                                                                    <Button
                                                                        Width="22"
                                                                        Height="22"
                                                                        Margin="2,0"
                                                                        Background="{StaticResource EmsPanelBackground_Green}"
                                                                        Click="{eb:MethodBinding AddProblemQuantity_FunctionObjective}"
                                                                        DockPanel.Dock="Right"
                                                                        ToolTip="Add quantity type as a variable of the Objective Function.">
                                                                        <Button.Content>
                                                                            <TextBlock FontFamily="Segoe UI Symbol" Text="◉" />
                                                                        </Button.Content>
                                                                    </Button>
                                                                    <Button
                                                                        Width="22"
                                                                        Height="22"
                                                                        Margin="2,0"
                                                                        Background="{StaticResource EmsPanelBackground_Yellow}"
                                                                        Click="{eb:MethodBinding AddProblemQuantity_ConstraintObjective}"
                                                                        DockPanel.Dock="Right"
                                                                        ToolTip="Add quantity type as a constraint variable.">
                                                                        <Button.Content>
                                                                            <TextBlock FontFamily="Segoe UI Symbol" Text="⛓" />
                                                                        </Button.Content>
                                                                    </Button>
                                                                    <Button
                                                                        Width="22"
                                                                        Height="22"
                                                                        Margin="2,0"
                                                                        Background="{StaticResource EmsPanelBackground_Gray}"
                                                                        Click="{eb:MethodBinding AddProblemQuantity_OutputOnly}"
                                                                        DockPanel.Dock="Right"
                                                                        ToolTip="Add quantity type as output only.">
                                                                        <Button.Content>
                                                                            <TextBlock FontFamily="Segoe UI Symbol" Text="" />
                                                                        </Button.Content>
                                                                    </Button>
                                                                    <ContentControl
                                                                        Margin="0,0,5,0"
                                                                        Content="{Binding}"
                                                                        ContentTemplate="{StaticResource IProblemQuantitySource_Designation}" />
                                                                </DockPanel>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </GroupBox>
                                                <GroupBox
                                                    Header="Finite Element Quantity"
                                                    Style="{StaticResource CenterHeader_GroupBox}"
                                                    Visibility="{Binding ElementName=MainGrid, Path=DataContext.FeOpt.IsFeProblem}">
                                                    <ItemsControl
                                                        x:Name="ProbQuantMgn_AvailableQuantities_FeResultClassification_Selection_ListBox"
                                                        ItemsSource="{Binding FeOpt.Wpf_SelectedFiniteElementResultsForOutput}"
                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                        Style="{StaticResource VirtualItemsControl}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <DockPanel Margin="0,2" LastChildFill="True">
                                                                    <Button
                                                                        Width="22"
                                                                        Height="22"
                                                                        Margin="2,0"
                                                                        Background="{StaticResource EmsPanelBackground_Green}"
                                                                        Click="{eb:MethodBinding AddProblemQuantity_FunctionObjective}"
                                                                        DockPanel.Dock="Right"
                                                                        ToolTip="Add quantity type as a variable of the Objective Function.">
                                                                        <Button.Content>
                                                                            <TextBlock FontFamily="Segoe UI Symbol" Text="◉" />
                                                                        </Button.Content>
                                                                    </Button>
                                                                    <Button
                                                                        Width="22"
                                                                        Height="22"
                                                                        Margin="2,0"
                                                                        Background="{StaticResource EmsPanelBackground_Yellow}"
                                                                        Click="{eb:MethodBinding AddProblemQuantity_ConstraintObjective}"
                                                                        DockPanel.Dock="Right"
                                                                        ToolTip="Add quantity type as a constraint variable.">
                                                                        <Button.Content>
                                                                            <TextBlock FontFamily="Segoe UI Symbol" Text="⛓" />
                                                                        </Button.Content>
                                                                    </Button>
                                                                    <Button
                                                                        Width="22"
                                                                        Height="22"
                                                                        Margin="2,0"
                                                                        Background="{StaticResource EmsPanelBackground_Gray}"
                                                                        Click="{eb:MethodBinding AddProblemQuantity_OutputOnly}"
                                                                        DockPanel.Dock="Right"
                                                                        ToolTip="Add quantity type as output only.">
                                                                        <Button.Content>
                                                                            <TextBlock FontFamily="Segoe UI Symbol" Text="" />
                                                                        </Button.Content>
                                                                    </Button>
                                                                    <ContentControl
                                                                        Margin="0,0,5,0"
                                                                        Content="{Binding}"
                                                                        ContentTemplate="{StaticResource IProblemQuantitySource_Designation}" />
                                                                </DockPanel>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </GroupBox>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </GroupBox>
                                    <GroupBox Grid.Column="2" Header="Selected Quantities">
                                        <ScrollViewer>
                                            <StackPanel
                                                Orientation="Vertical"
                                                ScrollViewer.CanContentScroll="True"
                                                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                                ScrollViewer.VerticalScrollBarVisibility="Visible">
                                                <Grid Margin="0,0,0,5">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Border Background="{StaticResource EmsPanelBorder_Gray}" BorderBrush="{StaticResource EmsPanelBorder_Gray}">
                                                        <TextBlock
                                                            Margin="3"
                                                            HorizontalAlignment="Center"
                                                            FontWeight="Bold"
                                                            Foreground="White"
                                                            Text="Output Only" />
                                                    </Border>
                                                    <ItemsControl
                                                        x:Name="ProbQuantMgn_SelectedQuantities_OutputOnly_ListBox"
                                                        Grid.Row="1"
                                                        Background="{StaticResource EmsPanelBackground_Gray}"
                                                        BorderBrush="{StaticResource EmsPanelBorder_Gray}"
                                                        BorderThickness="1"
                                                        ItemTemplate="{StaticResource ProbQuantMgn_SelectedQuantities_OutputOnly_ListBox_ItemTemplate}"
                                                        ItemsSource="{Binding ProbQuantMgn.WpfProblemQuantities_OutputOnly}"
                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                        Style="{StaticResource VirtualItemsControl}" />
                                                </Grid>
                                                <Grid Margin="0,0,0,5">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Border Background="{StaticResource EmsPanelBorder_Green}" BorderBrush="{StaticResource EmsPanelBorder_Green}">
                                                        <TextBlock
                                                            Margin="3"
                                                            HorizontalAlignment="Center"
                                                            FontWeight="Bold"
                                                            Foreground="White"
                                                            Text="Objective Function" />
                                                    </Border>
                                                    <ItemsControl
                                                        x:Name="ProbQuantMgn_SelectedQuantities_ObjectiveFunction_ListBox"
                                                        Grid.Row="1"
                                                        Background="{StaticResource EmsPanelBackground_Green}"
                                                        BorderBrush="{StaticResource EmsPanelBorder_Green}"
                                                        BorderThickness="1"
                                                        ItemTemplate="{StaticResource ProbQuantMgn_SelectedQuantities_ObjectiveFunction_ListBox_ItemTemplate}"
                                                        ItemsSource="{Binding ProbQuantMgn.WpfProblemQuantities_ObjectiveFunction}"
                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                        Style="{StaticResource VirtualItemsControl}" />
                                                </Grid>
                                                <Grid Margin="0,0,0,5">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Border Background="{StaticResource EmsPanelBorder_Yellow}" BorderBrush="{StaticResource EmsPanelBorder_Yellow}">
                                                        <TextBlock
                                                            Margin="3"
                                                            HorizontalAlignment="Center"
                                                            FontWeight="Bold"
                                                            Foreground="White"
                                                            Text="Constraints" />
                                                    </Border>
                                                    <ItemsControl
                                                        x:Name="ProbQuantMgn_SelectedQuantities_Constraints_ListBox"
                                                        Grid.Row="1"
                                                        Background="{StaticResource EmsPanelBackground_Yellow}"
                                                        BorderBrush="{StaticResource EmsPanelBorder_Yellow}"
                                                        BorderThickness="1"
                                                        ItemTemplate="{StaticResource ProbQuantMgn_SelectedQuantities_Constraints_ListBox_ItemTemplate}"
                                                        ItemsSource="{Binding ProbQuantMgn.WpfProblemQuantities_Constraint}"
                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                        Style="{StaticResource VirtualItemsControl}" />
                                                </Grid>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </GroupBox>
                                </Grid>
                            </GroupBox>
                            <Grid
                                Grid.Row="0"
                                Grid.RowSpan="2"
                                Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <GroupBox
                                    Grid.Row="0"
                                    Header="Optimization Optimizer Options"
                                    IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}"
                                    Style="{StaticResource Blue_GroupBox}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <GroupBox
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Header="Type">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="10" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <ComboBox
                                                    DisplayMemberPath="Value"
                                                    ItemsSource="{Binding NlOptOpt.NlOptAlgorithmEnumDescriptions}"
                                                    SelectedValue="{Binding NlOptOpt.NlOptSolverType}"
                                                    SelectedValuePath="Key" />
                                                <CheckBox
                                                    Grid.Column="2"
                                                    VerticalAlignment="Center"
                                                    Content="Lagrangian"
                                                    IsChecked="{Binding NlOptOpt.UseLagrangian}" />
                                            </Grid>
                                        </GroupBox>
                                        <GroupBox
                                            Grid.Row="1"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            ToolTip="Set Population Size. If not set, it will be calculated automatically."
                                            Visibility="{Binding NlOptOpt.SolverNeedsPopulationSize}">
                                            <GroupBox.Header>
                                                <CheckBox Content="Population Size" IsChecked="{Binding NlOptOpt.IsOn_PopulationSize}" />
                                            </GroupBox.Header>
                                            <TextBox
                                                h:DepObjs.CancelErrorOnLostFocus="True"
                                                IsEnabled="{Binding NlOptOpt.IsOn_PopulationSize}"
                                                Text="{Binding NlOptOpt.PopulationSize, ValidatesOnExceptions=True}" />
                                        </GroupBox>
                                        <GroupBox
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Header="Objective Function Sum Style"
                                            ToolTip="Chose the way in which the objective function problem quantities will be added together.">
                                            <ComboBox
                                                ItemsSource="{Binding NlOptOpt.ObjectiveFunctionSumTypeEnumDescriptions}"
                                                SelectedValue="{Binding NlOptOpt.ObjectiveFunctionSumType}"
                                                SelectedValuePath="Key">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Value.Item1}" ToolTip="{Binding Value.Item2}" />
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </GroupBox>
                                        <GroupBox
                                            Grid.Row="3"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="0,5,0,0"
                                            Header="Stop Controls"
                                            Style="{StaticResource CenterHeader_GroupBox}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />

                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>
                                                <GroupBox
                                                    Grid.Row="0"
                                                    Grid.Column="0"
                                                    Margin="2,0"
                                                    ToolTip="Stop when an objective value of at least stopval is found.&#x0a;Stop minimizing when an objective value ≤ stopval is found, or stop maximizing a value ≥ stopval is found.">
                                                    <GroupBox.Header>
                                                        <CheckBox Content="F Stop Value" IsChecked="{Binding NlOptOpt.IsOn_StopValueOnObjectiveFunction}" />
                                                    </GroupBox.Header>
                                                    <TextBox
                                                        h:DepObjs.CancelErrorOnLostFocus="True"
                                                        IsEnabled="{Binding NlOptOpt.IsOn_StopValueOnObjectiveFunction}"
                                                        Text="{Binding NlOptOpt.StopValueOnObjectiveFunction, ValidatesOnExceptions=True}" />
                                                </GroupBox>
                                                <GroupBox
                                                    Grid.Row="1"
                                                    Grid.Column="0"
                                                    Margin="2,0"
                                                    ToolTip="Set relative tolerance on function value.&#x0a;Stop when an optimization step (or an estimate of the optimum) changes the objective function value by less than tolerance multiplied&#x0a;by the absolute value of the function value.&#x0a;(If there is any chance that your optimum function value is close to zero, you might want to set an absolute tolerance as well.)">
                                                    <GroupBox.Header>
                                                        <CheckBox Content="F Relative Tolerance" IsChecked="{Binding NlOptOpt.IsOn_RelativeToleranceOnFunctionValue}" />
                                                    </GroupBox.Header>
                                                    <TextBox
                                                        h:DepObjs.CancelErrorOnLostFocus="True"
                                                        IsEnabled="{Binding NlOptOpt.IsOn_RelativeToleranceOnFunctionValue}"
                                                        Text="{Binding NlOptOpt.RelativeToleranceOnFunctionValue, ValidatesOnExceptions=True}" />
                                                </GroupBox>
                                                <GroupBox
                                                    Grid.Row="2"
                                                    Grid.Column="0"
                                                    Margin="2,0"
                                                    VerticalAlignment="Top"
                                                    ToolTip="Set absolute tolerance on function value.&#x0a;Stop when an optimization step (or an estimate of the optimum) changes the function value by less than tolerance.">
                                                    <GroupBox.Header>
                                                        <CheckBox Content="F Absolute Tolerance" IsChecked="{Binding NlOptOpt.IsOn_AbsoluteToleranceOnFunctionValue}" />
                                                    </GroupBox.Header>
                                                    <TextBox
                                                        h:DepObjs.CancelErrorOnLostFocus="True"
                                                        IsEnabled="{Binding NlOptOpt.IsOn_AbsoluteToleranceOnFunctionValue}"
                                                        Text="{Binding NlOptOpt.AbsoluteToleranceOnFunctionValue, ValidatesOnExceptions=True}" />
                                                </GroupBox>
                                                <GroupBox
                                                    Grid.Row="0"
                                                    Grid.Column="1"
                                                    Margin="2,0"
                                                    ToolTip="Set relative tolerance on optimization parameters.&#x0a;Stop when an optimization step (or an estimate of the optimum) causes a relative change the input X by less than tolerance.">
                                                    <GroupBox.Header>
                                                        <CheckBox Content="X Relative Tolerance" IsChecked="{Binding NlOptOpt.IsOn_RelativeToleranceOnParameterValue}" />
                                                    </GroupBox.Header>
                                                    <TextBox
                                                        h:DepObjs.CancelErrorOnLostFocus="True"
                                                        IsEnabled="{Binding NlOptOpt.IsOn_RelativeToleranceOnParameterValue}"
                                                        Text="{Binding NlOptOpt.RelativeToleranceOnParameterValue, ValidatesOnExceptions=True}" />
                                                </GroupBox>
                                                <GroupBox
                                                    Grid.Row="1"
                                                    Grid.Column="1"
                                                    Margin="2,0"
                                                    ToolTip="Sets the maximum number of iterations.">
                                                    <GroupBox.Header>
                                                        <CheckBox Content="Max. Iterations" IsChecked="{Binding NlOptOpt.IsOn_MaximumIterations}" />
                                                    </GroupBox.Header>
                                                    <TextBox
                                                        h:DepObjs.CancelErrorOnLostFocus="True"
                                                        IsEnabled="{Binding NlOptOpt.IsOn_MaximumIterations}"
                                                        Text="{Binding NlOptOpt.MaximumIterations, ValidatesOnExceptions=True}" />
                                                </GroupBox>
                                                <GroupBox
                                                    Grid.Row="2"
                                                    Grid.Column="1"
                                                    Margin="2,0"
                                                    VerticalAlignment="Top"
                                                    ToolTip="Sets the maximum solve time, in seconds.">
                                                    <GroupBox.Header>
                                                        <CheckBox Content="Max. Time" IsChecked="{Binding NlOptOpt.IsOn_MaximumRunTime}" />
                                                    </GroupBox.Header>
                                                    <TextBox
                                                        h:DepObjs.CancelErrorOnLostFocus="True"
                                                        IsEnabled="{Binding NlOptOpt.IsOn_MaximumRunTime}"
                                                        Text="{Binding NlOptOpt.MaximumRunTime, ValidatesOnExceptions=True}" />
                                                </GroupBox>

                                                <GroupBox
                                                    Grid.Row="3"
                                                    Grid.Column="0"
                                                    Grid.ColumnSpan="2"
                                                    Margin="2,0"
                                                    ToolTip="Set absolute tolerances on optimization parameters.&#x0a;Stop when an optimization step (or an estimate of the optimum) changes every parameter X[i] by less than its assigned tolerance. Criterion is disabled for a parameter X[i] if its tolerance is non-positive.">
                                                    <GroupBox.Header>
                                                        <CheckBox Content="X Absolute Tolerances" IsChecked="{Binding NlOptOpt.IsOn_AbsoluteToleranceOnParameterValue}" />
                                                    </GroupBox.Header>
                                                    <ItemsControl
                                                        x:Name="NonLinearOptimization_Setup_ListBox"
                                                        IsEnabled="{Binding NlOptOpt.IsOn_AbsoluteToleranceOnParameterValue}"
                                                        ItemsSource="{Binding NlOptOpt.AbsoluteToleranceOnParameterValue}"
                                                        Style="{StaticResource VirtualItemsControl}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width=".7*" />
                                                                        <ColumnDefinition />
                                                                    </Grid.ColumnDefinitions>
                                                                    <TextBlock Grid.Column="0" Text="{Binding ParameterName, Mode=OneWay}" />
                                                                    <TextBox
                                                                        Grid.Column="1"
                                                                        h:DepObjs.CancelErrorOnLostFocus="True"
                                                                        Text="{Binding ParameterTolerance, ValidatesOnExceptions=True}" />
                                                                </Grid>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </GroupBox>
                                            </Grid>
                                        </GroupBox>
                                    </Grid>
                                </GroupBox>
                                <GroupBox
                                    Grid.Row="1"
                                    Header="Controls"
                                    Style="{StaticResource Blue_GroupBox}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition Height="5" />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="5" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <Button
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Click="{eb:MethodBinding {Binding SolveMgr},
                                                                     WpfCommand_GenerateConfigurations_AndValidateForm}"
                                            Content="Generate"
                                            IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}" />
                                        <TextBlock
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            Margin="20,0,0,0"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource NumberTextBlock}">
                                            <Run Text="Generated: " />
                                            <Run Text="{Binding SolveMgr.Wpf_ConfigurationCount_Generated, Mode=OneWay}" />
                                        </TextBlock>
                                        <Button
                                            Grid.Row="0"
                                            Grid.Column="2"
                                            Click="{eb:MethodBinding {Binding SolveMgr},
                                                                     WpfCommand_ClearConfigurations}"
                                            Content="Clear"
                                            IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay}" />
                                        <Button
                                            x:Name="Solve"
                                            Grid.Row="2"
                                            Grid.Column="2"
                                            Click="Solve_Click"
                                            Content="Optimize"
                                            IsEnabled="{Binding SolveMgr.Wpf_ConfigurationsHaveBeenGenerated, Mode=OneWay}" />
                                    </Grid>
                                </GroupBox>
                                <Button
                                    Grid.Row="2"
                                    Click="Debug_Click"
                                    Content="Debug" />
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem
                        Height="22"
                        VerticalAlignment="Top"
                        Header="Results">
                        <TabControl>
                            <TabItem Header="Summary">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="1000" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <GroupBox
                                        Grid.Row="0"
                                        Grid.RowSpan="2"
                                        Grid.Column="0"
                                        Header="Problem Configurations"
                                        Style="{StaticResource Blue_GroupBox}">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="*" />
                                            </Grid.RowDefinitions>
                                            <Grid Grid.Row="0" Style="{StaticResource ListBoxHeaderGrid}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="43" />
                                                    <ColumnDefinition Width="220" />
                                                    <ColumnDefinition Width="90" />
                                                    <ColumnDefinition Width="95" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="{StaticResource VerticalScrollBarWidth}" />
                                                </Grid.ColumnDefinitions>
                                                <Label Grid.Column="0">
                                                    <TextBlock TextDecorations="underline">#</TextBlock>
                                                </Label>
                                                <Label Grid.Column="1">
                                                    <TextBlock TextDecorations="underline">Config. Definition</TextBlock>
                                                </Label>
                                                <Label Grid.Column="2">
                                                    <TextBlock TextDecorations="underline">Opt. Status</TextBlock>
                                                </Label>
                                                <Label Grid.Column="3" ToolTip="Last Point objective function evaluation.">
                                                    <TextBlock TextDecorations="underline">Last Point Eval</TextBlock>
                                                </Label>
                                                <Label Grid.Column="4" ToolTip="Last Point constraint status.">
                                                    <TextBlock TextDecorations="underline">Last Point Constraints</TextBlock>
                                                </Label>
                                                <Label Grid.Column="5" BorderThickness="0,1,0,1" />
                                            </Grid>
                                            <ListBox
                                                Grid.Row="1"
                                                ItemContainerStyle="{StaticResource ListBoxContainerStyle}"
                                                ItemTemplate="{StaticResource ResultsSummary_ProblemConfiguration_ItemTemplate}"
                                                ItemsSource="{Binding SolveMgr.Wpf_ProblemConfigs_View}"
                                                SelectedItem="{Binding SolveMgr.Wpf_CurrentlySelected_ProblemConfig}"
                                                SelectionMode="Single"
                                                Style="{StaticResource VirtualListBox}" />
                                        </Grid>
                                    </GroupBox>
                                    <GroupBox
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Header="General Status"
                                        Style="{StaticResource Blue_GroupBox}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <GroupBox
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Header="Count">
                                                <Grid Margin="3">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="5" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        Text="Successful" />
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        Text="{Binding SolveMgr.Wpf_ConfigurationCount_Successful, StringFormat={}{0:G1}, Mode=OneWay}" />

                                                    <Border
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Grid.ColumnSpan="3"
                                                        Margin="0,0,0,3"
                                                        BorderBrush="{StaticResource EmsLightGraySolidBrush}"
                                                        BorderThickness="0,1,0,0" />

                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        Text="Total" />
                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="2"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        Text="{Binding SolveMgr.Wpf_ConfigurationCount_Generated, StringFormat={}{0:D}, Mode=OneWay}" />

                                                </Grid>
                                            </GroupBox>
                                            <GroupBox
                                                Grid.Row="0"
                                                Grid.Column="1"
                                                Header="Elapsed time">
                                                <Grid Margin="3">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="5" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        Text="Average" />
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        ToolTip="Total time necessary for the optimization of all problem configurations.">
                                                        <Run Text="{Binding SolveMgr.AverageTotalSeconds_ConfigurationElapsedTime, StringFormat={}{0:F1}, Mode=OneWay}" />
                                                        <Run Text="s" />
                                                    </TextBlock>

                                                    <Border
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Grid.ColumnSpan="3"
                                                        Margin="0,0,0,3"
                                                        BorderBrush="{StaticResource EmsLightGraySolidBrush}"
                                                        BorderThickness="0,1,0,0" />

                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        Text="Total" />
                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="2"
                                                        Style="{StaticResource NumberTextBlock}"
                                                        ToolTip="Total time necessary for the optimization of all problem configurations.">
                                                        <Run Text="{Binding SolveMgr.TotalOptimizationElapsedTime.TotalSeconds, StringFormat={}{0:F1}, Mode=OneWay}" />
                                                        <Run Text="s" />
                                                    </TextBlock>
                                                </Grid>
                                            </GroupBox>

                                        </Grid>

                                    </GroupBox>
                                    <GroupBox
                                        Grid.Row="1"
                                        Grid.RowSpan="3"
                                        Grid.Column="1"
                                        Header="Best Problem Configuration's Last Point"
                                        Style="{StaticResource CenterHeader_GroupBox}">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="*" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <ContentControl
                                                Grid.Column="0"
                                                Grid.ColumnSpan="2"
                                                Margin="15 5 5 5"
                                                Content="{Binding SolveMgr.Wpf_BestEval_ProblemConfig}"
                                                ContentTemplate="{StaticResource ProblemConfiguration_Summary_ItemTemplate}" />
                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Style="{StaticResource NumberTextBlock}"
                                                ToolTip="Objective Function evaluation at the last point."
                                                Text="{Binding SolveMgr.Wpf_BestEval_ProblemConfig.LastPoint.ObjectiveFunctionEval, Converter={StaticResource DefaultNumberConverter}}" />
                                            <ItemsControl
                                                Grid.Row="1"
                                                Grid.Column="0"
                                                Grid.ColumnSpan="3"
                                                ItemTemplate="{StaticResource Point_OutputData_Detailed}"
                                                ItemsSource="{Binding SolveMgr.Wpf_BestEval_ProblemConfig.LastPoint.Wpf_ProblemQuantityOutputs}"
                                                Style="{StaticResource VirtualItemsControl}" />
                                        </Grid>
                                    </GroupBox>
                                </Grid>
                            </TabItem>
                            <!--  TODO: ADD OTHER RESULT ITEMS  -->
                        </TabControl>
                    </TabItem>
                </TabControl>
            </Grid>
        </Grid>
        <e:BusyOverlay x:Name="BusyOverlay" Visibility="Hidden" />
        <e:CustomOverlay
            x:Name="BusyOptimizingOverlay"
            BackgroundOpacity=".3"
            ContentHorizontalAlignment="Stretch"
            ContentMargin="40"
            ContentVerticalAlignment="Stretch"
            Visibility="Hidden">
            <e:CustomOverlay.AdditionalContent>
                <Grid Margin="10,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="450" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="200" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="10" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />

                    </Grid.RowDefinitions>
                    <GroupBox
                        Grid.Row="0"
                        Grid.RowSpan="2"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Header="Message">
                        <TextBlock
                            Margin="5,0"
                            VerticalAlignment="Center"
                            Text="{Binding Overlay_TopMessage}"
                            TextWrapping="Wrap" />
                    </GroupBox>
                    <Button
                        Grid.Row="0"
                        Grid.Column="5"
                        Width="150"
                        Height="28"
                        Margin="0,10,0,0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Click="CancelSolveButton_Click"
                        Content="Stop" />
                    <Grid
                        Grid.Row="1"
                        Grid.Column="5"
                        Height="25"
                        Margin="0,5,0,0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center">
                        <ProgressBar
                            Margin="5,1"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            IsIndeterminate="{Binding Overlay_ProgressBarIndeterminate}"
                            Maximum="{Binding Overlay_ProgressBarMaximum}"
                            Minimum="0"
                            Value="{Binding Overlay_ProgressBarCurrent}" />
                        <TextBlock
                            Margin="5,1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontFamily="Lucida Console"
                            FontSize="14"
                            Foreground="{StaticResource EmsDarkBlueSolidBrush}"
                            Style="{StaticResource VisibleOnTagTrue_HiddenOnTagFalse}"
                            Tag="{Binding Overlay_ProgressBarIndeterminate, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}">
                            <Run Text="{Binding Overlay_ProgressBarCurrent}" />
                            <Run Text="/" />
                            <Run Text="{Binding Overlay_ProgressBarMaximum}" />
                        </TextBlock>
                    </Grid>

                    <Border
                        Grid.Row="2"
                        Grid.Column="0"
                        Grid.ColumnSpan="3"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center"
                        BorderBrush="{StaticResource EmsDarkBlueSolidBrush}"
                        BorderThickness="0,2,0,0" />

                    <GroupBox
                        Grid.Row="3"
                        Grid.Column="0"
                        Header="Problem Configurations"
                        Style="{StaticResource Blue_GroupBox}">
                        <ItemsControl
                            ItemTemplate="{StaticResource Overview_ProblemConfig_ItemsControl_ItemTemplate}"
                            ItemsSource="{Binding SolveMgr.Wpf_ProblemConfigs_View}"
                            Style="{StaticResource VirtualItemsControl}"
                            Tag="OverlayProblemConfigurationList" />
                    </GroupBox>
                    <GroupBox
                        Grid.Row="4"
                        Grid.Column="0"
                        Header="Current Optimization"
                        Style="{StaticResource Blue_GroupBox}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <GroupBox
                                Grid.Row="0"
                                Header="Non-Linear Inputs"
                                Style="{StaticResource CenterHeader_GroupBox}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Style="{StaticResource ListBoxHeaderGrid}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="20" />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="{StaticResource VerticalScrollBarWidth}" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0">
                                            <TextBlock TextDecorations="underline">Id</TextBlock>
                                        </Label>
                                        <Label Grid.Column="1">
                                            <TextBlock TextDecorations="underline">Parameter</TextBlock>
                                        </Label>
                                        <Label Grid.Column="2">
                                            <TextBlock TextDecorations="underline">Previous</TextBlock>
                                        </Label>
                                        <Label Grid.Column="3">
                                            <TextBlock TextDecorations="underline">Current</TextBlock>
                                        </Label>
                                        <Label Grid.Column="4">
                                            <TextBlock TextDecorations="underline">Delta</TextBlock>
                                        </Label>
                                        <Label Grid.Column="5" BorderThickness="0,1,0,1" />
                                    </Grid>
                                    <ItemsControl
                                        Grid.Row="1"
                                        ItemTemplate="{StaticResource Overview_CurrentProblemConfig_LastPoint_InputDetails_ItemsControl_ItemTemplate}"
                                        ItemsSource="{Binding SolveMgr.CurrentCalculatingProblemConfig.Wpf_CalculatingInputDisplay}"
                                        Style="{StaticResource VirtualItemsControl}" />
                                </Grid>
                            </GroupBox>

                        </Grid>
                    </GroupBox>
                    <GroupBox
                        Grid.Row="3"
                        Grid.RowSpan="2"
                        Grid.Column="1"
                        Grid.ColumnSpan="2"
                        Header="Last Calculated Function Point"
                        Style="{StaticResource Blue_GroupBox}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <GroupBox
                                Grid.Row="0"
                                Grid.Column="0"
                                Header="Finite Element Quantity">
                                <ComboBox
                                    ItemTemplate="{StaticResource IProblemQuantitySource_Designation}"
                                    ItemsSource="{Binding ScreenShotOpt.Wpf_ScreenshotList}"
                                    SelectedItem="{Binding ScreenShotOpt.SelectedDisplayImageResultClassification}" />
                            </GroupBox>
                            <GroupBox
                                Grid.Row="0"
                                Grid.Column="1"
                                Header="Orientation">
                                <ComboBox
                                    VerticalContentAlignment="Center"
                                    ItemsSource="{Binding ScreenShotOpt.ImageCapture_ViewDirectionsEnumerable}"
                                    SelectedItem="{Binding ScreenShotOpt.SelectedDisplayDirection}" />
                            </GroupBox>
                            <Image
                                Grid.Row="1"
                                Grid.Column="0"
                                Grid.ColumnSpan="2"
                                Width="810"
                                Height="610"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                SnapsToDevicePixels="True"
                                Source="{Binding SolveMgr.CurrentCalculatingProblemConfig.LastPoint.SelectedDisplayScreenShot}"
                                Stretch="None" />
                        </Grid>
                    </GroupBox>
                </Grid>
            </e:CustomOverlay.AdditionalContent>
        </e:CustomOverlay>
    </Grid>
</Window>
