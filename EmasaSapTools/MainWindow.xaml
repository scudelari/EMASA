<Window
    x:Class="EmasaSapTools.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:e="clr-namespace:BaseWPFLibrary;assembly=BaseWPFLibrary"
    xmlns:eb="clr-namespace:BaseWPFLibrary.Bindings;assembly=BaseWPFLibrary"
    xmlns:ec="clr-namespace:BaseWPFLibrary.Converters;assembly=BaseWPFLibrary"
    xmlns:ev="clr-namespace:BaseWPFLibrary.ValidationRules;assembly=BaseWPFLibrary"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:system="clr-namespace:System;assembly=mscorlib"
    x:Name="MainAppWindow"
    Title="Emasa Sap2000 Tools"
    Width="1200"
    Height="900"
    Activated="Window_Activated"
    Closing="MainAppWindow_Closing"
    Initialized="Window_Initialized"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <DockPanel>
        <StatusBar
            x:Name="WindowStatusBar"
            DockPanel.Dock="Bottom"
            FontFamily="Courier New">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="75" />
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            <TextBlock Style="{DynamicResource CodeText_TextBlock}" Text="MODEL:" />
            <StatusBarItem Grid.Column="1">
                <TextBlock
                    Style="{DynamicResource RedOnFalseTag_TextBlock}"
                    Tag="{Binding Sap2000IsOpen}"
                    Text="{Binding SapFileName}" />
            </StatusBarItem>
            <Separator Grid.Column="2" />
            <StatusBarItem Grid.Column="3" Margin="0">
                <ItemsControl ItemsSource="{Binding MonitorList}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock
                                IsEnabled="False"
                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                Tag="{Binding Constraint_IsEnabled}"
                                Text="{Binding ShortName}" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel IsItemsHost="True" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>

            </StatusBarItem>
        </StatusBar>
        <Grid>
            <TabControl
                x:Name="MainTabControl"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch">
                <TabItem Header="Joint Constraints" IsEnabled="{Binding SapAvailableIsEnabled}">
                    <DockPanel>
                        <Grid Width="600" DockPanel.Dock="Left">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <GroupBox
                                x:Name="ConstraintsAddGroupBox"
                                Grid.Row="0"
                                Header="Constraints - Monitor and Manipulator"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Orientation="Vertical">
                                    <GroupBox>
                                        <GroupBox.Header>
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Checked="{eb:MethodBinding ConstraintMonitorCheckBox_Checked}"
                                                    Content="Enable"
                                                    IsChecked="{Binding Constraint_IsEnabled}"
                                                    Unchecked="{eb:MethodBinding ConstraintMonitorCheckBox_Unchecked}" />
                                            </StackPanel>
                                        </GroupBox.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width=".7*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <GroupBox
                                                    Grid.Column="0"
                                                    Header="Joints"
                                                    Style="{DynamicResource CenterHeader_GroupBox}">
                                                    <ListBox
                                                        Height="152"
                                                        ec:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding SelectedProbePoints}"
                                                        ItemsSource="{Binding SapSelectedPointList}"
                                                        ScrollViewer.CanContentScroll="True"
                                                        ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                        ScrollViewer.VerticalScrollBarVisibility="Visible"
                                                        SelectionMode="Multiple">
                                                        <ListBox.ItemTemplate>
                                                            <DataTemplate>
                                                                <TextBlock Text="{Binding Name}" />
                                                            </DataTemplate>
                                                        </ListBox.ItemTemplate>
                                                    </ListBox>
                                                </GroupBox>
                                                <GroupBox
                                                    Grid.Column="1"
                                                    Header="Constraints"
                                                    Style="{DynamicResource CenterHeader_GroupBox}">
                                                    <DockPanel>
                                                        <WrapPanel DockPanel.Dock="Bottom" Orientation="Horizontal">
                                                            <TextBlock Margin="2,5,0,5" Text="Selected:" />
                                                            <TextBlock Margin="2,5" Text="{Binding SelConstraint_Type}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_U1}"
                                                                Text="U1"
                                                                Visibility="{Binding SelConstraint_HasDoFVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_U2}"
                                                                Text="U2"
                                                                Visibility="{Binding SelConstraint_HasDoFVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_U3}"
                                                                Text="U3"
                                                                Visibility="{Binding SelConstraint_HasDoFVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_R1}"
                                                                Text="R1"
                                                                Visibility="{Binding SelConstraint_HasDoFVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_R2}"
                                                                Text="R2"
                                                                Visibility="{Binding SelConstraint_HasDoFVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_R3}"
                                                                Text="R3"
                                                                Visibility="{Binding SelConstraint_HasDoFVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_AxisX}"
                                                                Text="Axis X"
                                                                Visibility="{Binding SelConstraint_HasAxisXVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_AxisY}"
                                                                Text="Axis Y"
                                                                Visibility="{Binding SelConstraint_HasAxisYVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_AxisZ}"
                                                                Text="Axis Z"
                                                                Visibility="{Binding SelConstraint_HasAxisZVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Style="{DynamicResource GreenGrayOnBoolTag_TextBlock}"
                                                                Tag="{Binding SelConstraint_AxisAuto}"
                                                                Text="AutoAxis"
                                                                Visibility="{Binding SelConstraint_HasAxisAutoVis}" />
                                                            <TextBlock
                                                                Margin="2,5"
                                                                Text="{Binding SelConstraint_cSys}"
                                                                Visibility="{Binding SelConstraint_HasCSysVis}" />
                                                        </WrapPanel>
                                                        <ListView
                                                            Height="100"
                                                            ItemsSource="{Binding SapSelectedPointConstraintList}"
                                                            ScrollViewer.CanContentScroll="True"
                                                            ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                            ScrollViewer.VerticalScrollBarVisibility="Visible"
                                                            SelectedItem="{Binding SelectedMonitor}"
                                                            SelectionMode="Single"
                                                            Style="{DynamicResource Stretch}">
                                                            <ListView.View>
                                                                <GridView AllowsColumnReorder="False">
                                                                    <GridView.Columns>
                                                                        <GridViewColumn Width="25" Header="All">
                                                                            <GridViewColumn.CellTemplate>
                                                                                <DataTemplate>
                                                                                    <Grid HorizontalAlignment="Stretch">
                                                                                        <Ellipse
                                                                                            Width="10"
                                                                                            Height="10"
                                                                                            HorizontalAlignment="Center"
                                                                                            Style="{DynamicResource GreenRedEllipse}"
                                                                                            Tag="{Binding AllPointsHaveIt}" />
                                                                                    </Grid>
                                                                                </DataTemplate>
                                                                            </GridViewColumn.CellTemplate>
                                                                        </GridViewColumn>
                                                                        <GridViewColumn Width="25" Header="Sel.">
                                                                            <GridViewColumn.CellTemplate>
                                                                                <DataTemplate>
                                                                                    <Grid HorizontalAlignment="Stretch">
                                                                                        <Ellipse
                                                                                            Width="10"
                                                                                            Height="10"
                                                                                            HorizontalAlignment="Center"
                                                                                            Style="{DynamicResource GreenRedEllipse}"
                                                                                            Tag="{Binding SelPointHasIt}" />
                                                                                    </Grid>
                                                                                </DataTemplate>
                                                                            </GridViewColumn.CellTemplate>
                                                                        </GridViewColumn>
                                                                        <GridViewColumn
                                                                            Width="240"
                                                                            DisplayMemberBinding="{Binding ConstraintName}"
                                                                            Header="ShortName" />
                                                                    </GridView.Columns>
                                                                </GridView>
                                                            </ListView.View>
                                                        </ListView>
                                                    </DockPanel>
                                                </GroupBox>
                                            </Grid>
                                        </Grid>
                                    </GroupBox>
                                    <Separator Background="{Binding Path=BorderBrush, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type GroupBox}, AncestorLevel=1}}" />
                                    <StackPanel Orientation="Vertical">
                                        <GroupBox Header="New Constraint">
                                            <DockPanel>
                                                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">

                                                    <StackPanel Margin="5" Orientation="Vertical">
                                                        <RadioButton
                                                            x:Name="BodyConstraintTypeRadioButton"
                                                            Content="Body [B]"
                                                            GroupName="AddConstraint_Type"
                                                            IsChecked="{Binding BodyConstraintTypeRadioButton_IsChecked}" />
                                                        <RadioButton
                                                            x:Name="EqualConstraintTypeRadioButton"
                                                            Content="Equal [E]"
                                                            GroupName="AddConstraint_Type"
                                                            IsChecked="{Binding EqualConstraintTypeRadioButton_IsChecked}" />
                                                        <RadioButton
                                                            x:Name="LocalConstraintTypeRadioButton"
                                                            Content="Local [L]"
                                                            GroupName="AddConstraint_Type"
                                                            IsChecked="{Binding LocalConstraintTypeRadioButton_IsChecked}" />
                                                    </StackPanel>
                                                    <Rectangle
                                                        Width="1"
                                                        Margin="0,2,0,5"
                                                        VerticalAlignment="Stretch"
                                                        Stroke="LightGray" />
                                                    <StackPanel
                                                        Width="40"
                                                        Margin="5"
                                                        Orientation="Vertical">
                                                        <CheckBox Content="{Binding U1CheckBox_Label}" IsChecked="{Binding U1CheckBox_IsChecked}" />
                                                        <CheckBox Content="{Binding U2CheckBox_Label}" IsChecked="{Binding U2CheckBox_IsChecked}" />
                                                        <CheckBox Content="{Binding U3CheckBox_Label}" IsChecked="{Binding U3CheckBox_IsChecked}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Width="40"
                                                        Margin="5"
                                                        Orientation="Vertical">
                                                        <CheckBox Content="{Binding R1CheckBox_Label}" IsChecked="{Binding R1CheckBox_IsChecked}" />
                                                        <CheckBox Content="{Binding R2CheckBox_Label}" IsChecked="{Binding R2CheckBox_IsChecked}" />
                                                        <CheckBox Content="{Binding R3CheckBox_Label}" IsChecked="{Binding R3CheckBox_IsChecked}" />
                                                    </StackPanel>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="40" />
                                                            <ColumnDefinition Width="200" />
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="*" />
                                                            <RowDefinition Height="*" />
                                                        </Grid.RowDefinitions>
                                                        <TextBlock
                                                            Grid.Row="0"
                                                            Grid.Column="0"
                                                            Text="Prefix:" />
                                                        <TextBox
                                                            Grid.Row="0"
                                                            Grid.Column="1"
                                                            HorizontalAlignment="Stretch"
                                                            Text="{Binding ConstraintPrefix_Text, UpdateSourceTrigger=PropertyChanged}" />
                                                        <TextBlock
                                                            Grid.Row="1"
                                                            Grid.Column="0"
                                                            Text="Name:" />
                                                        <TextBlock
                                                            Grid.Row="1"
                                                            Grid.Column="1"
                                                            FontFamily="Courier New"
                                                            Text="{Binding ConstraintName_Label}" />
                                                    </Grid>
                                                </StackPanel>
                                                <Button
                                                    Width="100"
                                                    Height="{DynamicResource EmsDefaultButtonHeight}"
                                                    HorizontalAlignment="Center"
                                                    Command="{Binding AddConstraintButtonCommand}"
                                                    Content="Add" />
                                            </DockPanel>
                                        </GroupBox>
                                    </StackPanel>
                                    <Grid Margin="0,5,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button
                                            Grid.Column="0"
                                            Width="100"
                                            Command="{Binding MergeConstraintButtonCommand}"
                                            Content="Merge"
                                            IsEnabled="{Binding MakeSameConstraintButton_IsEnabled}" />
                                        <Button
                                            Grid.Column="1"
                                            Width="100"
                                            Margin="45,0,44,0"
                                            VerticalAlignment="Top"
                                            Command="{Binding DeleteConstraintButtonCommand}"
                                            Content="Delete All"
                                            IsEnabled="{Binding DeleteConstraintFromSelectionButton_IsEnabled}" />
                                    </Grid>
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                x:Name="ConstraintCleanup_GroupBox"
                                Grid.Row="1"
                                Header="Constraints - Cleanup"
                                Style="{DynamicResource Blue_GroupBox}">
                                <DockPanel>
                                    <StackPanel
                                        Margin="0"
                                        HorizontalAlignment="Center"
                                        DockPanel.Dock="Top"
                                        Orientation="Horizontal">
                                        <Button
                                            Width="200"
                                            Margin="0"
                                            Command="{Binding GetConstraintReportButtonCommand}"
                                            Content="Report Constraint" />
                                        <TextBlock Margin="15,0,5,0" Text="RegEx Filter:" />
                                        <TextBox Width="100" Text="{Binding RegExFilter_Text, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <TextBlock
                                        Margin="5"
                                        VerticalAlignment="Center"
                                        DockPanel.Dock="Top"
                                        Text="{Binding ConstraintReportSummaryTextBlock_Text}"
                                        TextAlignment="Center" />
                                    <StackPanel
                                        Margin="0"
                                        HorizontalAlignment="Center"
                                        DockPanel.Dock="Bottom"
                                        Orientation="Horizontal">
                                        <Button
                                            Width="200"
                                            Margin="0,5,5,0"
                                            Command="{Binding DeleteUnusedButtonCommand}"
                                            Content="{Binding DeleteUnusedConstraintsButton_Content}"
                                            IsEnabled="{Binding DeleteUnusedConstraintsButton_IsEnabled}" />
                                        <Button
                                            Width="100"
                                            Margin="30,5,5,0"
                                            HorizontalAlignment="Left"
                                            Command="{Binding DeleteSelectedButtonCommand}"
                                            Content="Delete Selected"
                                            IsEnabled="{Binding DeleteSelectedConstraintButton_IsEnabled}" />
                                    </StackPanel>
                                    <DataGrid
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        ec:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding ConstraintCleanupDataGrid_Selected}"
                                        AutoGenerateColumns="False"
                                        CanUserResizeColumns="False"
                                        IsReadOnly="True"
                                        ItemsSource="{Binding ConstraintCleanupDataGrid_ViewItems}"
                                        SelectionMode="Extended">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn
                                                Width="*"
                                                Binding="{Binding ConstraintName}"
                                                Header="Constraint ShortName">
                                                <DataGridTextColumn.CellStyle>
                                                    <Style>
                                                        <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn
                                                Width="50"
                                                Binding="{Binding ConstraintType}"
                                                Header="Type">
                                                <DataGridTextColumn.CellStyle>
                                                    <Style>
                                                        <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn
                                                Width="60"
                                                Binding="{Binding NumberPoints}"
                                                Header="# Points">
                                                <DataGridTextColumn.CellStyle>
                                                    <Style>
                                                        <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn
                                                Width="100"
                                                Binding="{Binding PointMaxDistance, StringFormat=F3}"
                                                Header="Max. Distance">
                                                <DataGridTextColumn.CellStyle>
                                                    <Style>
                                                        <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridTextColumn.CellStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </DockPanel>
                            </GroupBox>
                        </Grid>
                        <StackPanel
                            x:Name="Test_StackPanel"
                            Width="300"
                            DockPanel.Dock="Right">
                            <TextBlock
                                Margin="0,10"
                                Text="These pieces of code have been done too fast and must be refactored into useful functions"
                                TextDecorations="Underline"
                                TextWrapping="Wrap" />
                            <Button
                                x:Name="TESTER"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="TESTER_Click"
                                Content="Remove Groups From Points" />
                            <Button
                                x:Name="TESTER2"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="TESTER2_Click"
                                Content="Rename Ordenated Files" />
                            <Button
                                x:Name="TESTER3"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="TESTER3_Click"
                                Content="Add Sine Shape" />
                            <Button
                                x:Name="TESTER4"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="TESTER4_Click"
                                Content="Fix Saved Steps" />
                            <Button
                                x:Name="TESTER5"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="TESTER5_Click"
                                Content="Check aid change" />
                            <Button
                                x:Name="MovePointOntoLineButton"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="MovePointOntoLineButton_Click"
                                Content="Move Point Onto Line" />
                            <Button
                                x:Name="SelectTesterButton"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="SelectTesterButton_Click"
                                Content="Select Points and LGS" />
                            <Button
                                x:Name="SwapSurveyPointButton"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="SwapSurveyPointButton_Click"
                                Content="Swap Survey Points to Ignored or Not" />
                            <Button
                                x:Name="AddCrownToSiButton"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="AddCrownToSiButton_Click"
                                Content="Add Crown Elements to SI elements" />
                            <Button
                                x:Name="FixLocalTopOfPostButton"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="FixLocalTopOfPostButton_Click"
                                Content="Fix Local Constraints Top of Post" />

                            <Button
                                x:Name="DebugButton"
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Click="Debug_Click"
                                Content="Debug" />
                            <Button
                                Width="200"
                                Height="50"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Command="{Binding AutomationTestButtonCommand}"
                                Content="Automation Tester" />
                        </StackPanel>
                        <StackPanel />
                    </DockPanel>
                </TabItem>
                <TabItem Header="Align Items" IsEnabled="{Binding SapAvailableIsEnabled}">
                    <Grid x:Name="AlignItems_TabItem_Panel">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="300" />
                            <ColumnDefinition Width="430" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <StackPanel
                            Grid.Column="0"
                            HorizontalAlignment="Stretch"
                            Orientation="Vertical">
                            <GroupBox x:Name="AlignAreaGroupBox" Header="Align Area">
                                <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                    <StackPanel Margin="0" Orientation="Horizontal">
                                        <RadioButton
                                            x:Name="AlignAreaPlane31RadioButton"
                                            Margin="0,0,0,0"
                                            VerticalAlignment="Center"
                                            Content="Plane 3-1"
                                            GroupName="AlignAreaPlane"
                                            IsChecked="{Binding Plane31_IsChecked}" />
                                        <RadioButton
                                            x:Name="AlignAreaPlane32RadioButton"
                                            Margin="10,0,0,0"
                                            VerticalAlignment="Center"
                                            Content="Plane 3-2"
                                            GroupName="AlignAreaPlane"
                                            IsChecked="{Binding Plane32_IsChecked}" />
                                        <Button
                                            x:Name="BeginAlignAreaButton"
                                            Width="100"
                                            Margin="30,0,0,0"
                                            HorizontalAlignment="Stretch"
                                            Click="BeginAlignAreaButton_Click"
                                            Content="Align" />
                                    </StackPanel>
                                    <Button
                                        x:Name="AlignAreaSwapButton"
                                        Grid.Row="1"
                                        Width="150"
                                        Margin="0,5,0,0"
                                        HorizontalAlignment="Stretch"
                                        Click="AlignAreaSwapButton_Click"
                                        Content="Flip Last"
                                        IsEnabled="{Binding FlipLastButton_IsEnabled}" />
                                </StackPanel>
                            </GroupBox>
                            <GroupBox x:Name="AlignFrameGroupBox" Header="Align Frame">
                                <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                    <StackPanel Margin="0" Orientation="Horizontal">
                                        <RadioButton
                                            Margin="0,0,0,0"
                                            VerticalAlignment="Center"
                                            Content="Plane 1-2"
                                            GroupName="AlignFramePlane"
                                            IsChecked="{Binding Plane12_IsChecked}" />
                                        <RadioButton
                                            Margin="10,0,0,0"
                                            VerticalAlignment="Center"
                                            Content="Plane 1-3"
                                            GroupName="AlignFramePlane"
                                            IsChecked="{Binding Plane13_IsChecked}" />
                                        <Button
                                            x:Name="BeginAlignFrameButton"
                                            Width="100"
                                            Margin="30,0,0,0"
                                            HorizontalAlignment="Stretch"
                                            Click="BeginAlignFrameButton_Click"
                                            Content="Align" />
                                    </StackPanel>
                                    <Button
                                        x:Name="AlignFrameSwapButton"
                                        Width="150"
                                        Margin="0,5,0,0"
                                        HorizontalAlignment="Stretch"
                                        Click="AlignFrameSwapButton_Click"
                                        Content="Flip Last"
                                        IsEnabled="{Binding FlipLastButton_IsEnabled}" />
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                x:Name="AlignJointsGroupBox"
                                Header="Align Joints"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel HorizontalAlignment="Stretch" Orientation="Vertical">
                                    <GroupBox
                                        Margin="5"
                                        HorizontalAlignment="Stretch"
                                        Header="Align Joints to Their Connected Frames">
                                        <StackPanel Orientation="Vertical">
                                            <TextBlock
                                                Margin="3"
                                                Foreground="DimGray"
                                                TextWrapping="Wrap">
                                                <Run>Will align the local 1 direction of the joints to the selected frames.</Run>
                                                <LineBreak />
                                                <Run>- If a joint is selected, then only the selected joints will be treated. If a joint is selected without a connected frame, then the closest selected frame will be used for alignment.</Run>
                                                <LineBreak />
                                                <Run>- If no joint is selected, then both the I and J nodes of the frames will be aligned.</Run>
                                            </TextBlock>
                                            <CheckBox
                                                Margin="5"
                                                Content="Always Upwards"
                                                IsChecked="{Binding AlwaysUpwards_IsChecked}" />
                                            <Button
                                                x:Name="BeginAlignJointToFramesButton"
                                                Width="150"
                                                Margin="0,5,0,0"
                                                Click="BeginAlignJointToFramesButton_Click"
                                                Content="Align" />
                                        </StackPanel>
                                    </GroupBox>
                                    <GroupBox
                                        Margin="5"
                                        HorizontalAlignment="Stretch"
                                        Header="Align Selected Joints to Reference">
                                        <StackPanel Orientation="Vertical">
                                            <TextBlock
                                                Margin="3"
                                                Foreground="DimGray"
                                                TextWrapping="Wrap">
                                                <Run>Will align the selected joints to a reference, which may be a frame or two other points.</Run>
                                                <LineBreak />
                                                <Run>1- Select the points to be align.</Run>
                                                <LineBreak />
                                                <Run>2- Click the &quot;Align&quot; Button.</Run>
                                                <LineBreak />
                                                <Run>3- Select the reference (two points or one frame).</Run>
                                            </TextBlock>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <Button
                                                    x:Name="BeginAlignJointToSelectedFramesButton"
                                                    Grid.Column="0"
                                                    Margin="5,5,5,0"
                                                    Click="BeginAlignJointToSelectedFramesButton_Click"
                                                    Content="Align" />
                                                <Button
                                                    x:Name="AlignPointSwapButton"
                                                    Grid.Column="1"
                                                    Margin="5,5,5,0"
                                                    Click="AlignPointSwapButton_Click"
                                                    Content="Flip Last"
                                                    IsEnabled="{Binding AlignPointFlipLast_IsEnabled}" />
                                            </Grid>
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                    </Grid>
                </TabItem>
                <TabItem
                    x:Name="ManipulateItems_TabItem"
                    Header="Manipulate Items"
                    IsEnabled="{Binding SapAvailableIsEnabled}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="300" />
                            <ColumnDefinition Width="400" />
                            <ColumnDefinition Width="300" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <StackPanel
                            Grid.Column="0"
                            HorizontalAlignment="Stretch"
                            Orientation="Vertical">
                            <GroupBox
                                x:Name="ExtendOrShrinkLineGroupBox"
                                Header="Extend or Shrink Lines"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel VerticalAlignment="Top">
                                    <StackPanel VerticalAlignment="Center" Orientation="Vertical">
                                        <TextBlock
                                            Margin="0,0,0,10"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            TextWrapping="Wrap">
                                            <Run Text="Select the lines to alter and their joints to move." TextDecorations="Underline" />
                                        </TextBlock>
                                        <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                                <TextBlock
                                                    Margin="0,0,10,0"
                                                    VerticalAlignment="Center"
                                                    Text="Move with the Point:"
                                                    TextAlignment="Right" />
                                                <StackPanel HorizontalAlignment="Left" Orientation="Vertical">
                                                    <RadioButton
                                                        Margin="0,0,0,5"
                                                        Content="Only the Line"
                                                        GroupName="ExtendShrinkLineWithDistance"
                                                        IsChecked="{Binding OnlyTheLine_IsChecked}" />
                                                    <RadioButton
                                                        Content="All Elements"
                                                        GroupName="ExtendShrinkLineWithDistance"
                                                        IsChecked="{Binding AllElements_IsChecked}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>
                                        <GroupBox Margin="0,5,0,0" Header="By Distance">
                                            <StackPanel
                                                Margin="0"
                                                HorizontalAlignment="Center"
                                                Orientation="Vertical">

                                                <StackPanel
                                                    Margin="0"
                                                    HorizontalAlignment="Center"
                                                    Orientation="Horizontal">
                                                    <TextBlock VerticalAlignment="Center" Text="Distance:" />
                                                    <TextBox
                                                        x:Name="ExtendFrameDistanceTextBox"
                                                        Width="50"
                                                        Margin="5,0"
                                                        VerticalAlignment="Center"
                                                        Text="{Binding ExtendDistance}" />
                                                    <TextBlock VerticalAlignment="Center" Text="(-) to shrink" />
                                                    <Button
                                                        x:Name="ExtendFrameAlterButton"
                                                        Grid.Row="2"
                                                        Width="70"
                                                        Margin="10,5"
                                                        HorizontalAlignment="Center"
                                                        Click="ExtendFrameAlterButton_Click"
                                                        Content="Alter Line" />
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>
                                        <GroupBox Header="Relative to Other Line">
                                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                                <TextBlock
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    TextWrapping="Wrap">
                                                    <Run Text="Extend/Shrink to: " />
                                                </TextBlock>
                                                <StackPanel
                                                    Margin="0,5"
                                                    HorizontalAlignment="Left"
                                                    Orientation="vertical">
                                                    <RadioButton
                                                        Content="Closest point on target line"
                                                        GroupName="ExtendShrinkLineProjection"
                                                        IsChecked="{Binding Closest_IsChecked}" />
                                                    <RadioButton
                                                        Margin="0,5,0,5"
                                                        Content="Z-Aligned projection on target line"
                                                        GroupName="ExtendShrinkLineProjection"
                                                        IsChecked="{Binding ZAlignProjection_IsChecked}" />
                                                </StackPanel>
                                                <Button
                                                    x:Name="ExtendFrameProceedToOthersButton"
                                                    Width="100"
                                                    HorizontalAlignment="Center"
                                                    Click="ExtendFrameProceedToOthersButton_Click"
                                                    Content="Proceed" />
                                            </StackPanel>
                                        </GroupBox>
                                    </StackPanel>
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                x:Name="CreateSpliceGroupBox"
                                Header="Create Splice"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel VerticalAlignment="Top">
                                    <StackPanel VerticalAlignment="Center" Orientation="Vertical">
                                        <TextBlock
                                            Margin="15,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            TextWrapping="Wrap">
                                            <Run Text="Select per splice: " TextDecorations="Underline" />
                                        </TextBlock>
                                        <TextBlock
                                            Margin="25,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            TextWrapping="Wrap">
                                            <Run Text="- One Point." />
                                        </TextBlock>
                                        <TextBlock
                                            Margin="25,0,0,10"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            TextWrapping="Wrap">
                                            <Run Text="- Lines on Both Sides (Must be Colinear)." />
                                        </TextBlock>
                                    </StackPanel>
                                    <DockPanel>
                                        <TextBlock
                                            Margin="5,0"
                                            VerticalAlignment="Center"
                                            DockPanel.Dock="Left">
                                            Total Splice Length:
                                        </TextBlock>
                                        <TextBox
                                            Width="50"
                                            VerticalAlignment="Center"
                                            DockPanel.Dock="Left"
                                            Text="{Binding TotalSpliceLength}" />
                                        <Button
                                            x:Name="CreateSplicesButton"
                                            Width="Auto"
                                            Margin="5,0"
                                            HorizontalAlignment="Stretch"
                                            Click="CreateSplicesButton_Click"
                                            Content="Create Splices" />
                                    </DockPanel>
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                        <StackPanel Grid.Column="1" Orientation="Vertical">
                            <GroupBox
                                x:Name="BreakFrames_GroupBox"
                                Margin="5"
                                Header="Break Frames"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Orientation="Vertical">
                                    <GroupBox Margin="3,0,3,3" Header="Closest Point">
                                        <StackPanel Orientation="Vertical">
                                            <TextBlock
                                                Foreground="DimGray"
                                                Text="Select one point and a frame. The frame will be broken at the closest location to the selected point."
                                                TextWrapping="Wrap" />
                                            <Grid>
                                                <StackPanel Orientation="Vertical">
                                                    <Border
                                                        Width="200"
                                                        Margin="0,5,0,0"
                                                        HorizontalAlignment="Center"
                                                        Style="{DynamicResource BottomOnly_Border}">
                                                        <CheckBox
                                                            Margin="0,0,0,0"
                                                            HorizontalAlignment="Center"
                                                            Content="Add Constraint"
                                                            IsChecked="{Binding ClosestPointAddConstraint_IsChecked}" />
                                                    </Border>
                                                    <Border Margin="0,1,0,5" Style="{DynamicResource TopBottom_Border}">
                                                        <DockPanel IsEnabled="{Binding ClosestPointAddConstraint_IsChecked}">
                                                            <StackPanel
                                                                Margin="5"
                                                                DockPanel.Dock="Right"
                                                                Orientation="Vertical">
                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Margin="0,0,5,0" Text="Prefix:" />
                                                                    <TextBox Width="100" Text="{Binding ConstraintPrefix_Text}" />
                                                                </StackPanel>
                                                                <TextBlock
                                                                    Width="150"
                                                                    Margin="0,5"
                                                                    TextWrapping="Wrap">
                                                                    <Run Text="ShortName: " />
                                                                    <Run FontFamily="Courier New" Text="{Binding ConstraintName_Label}" />
                                                                    <Run Text="." />
                                                                </TextBlock>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock
                                                                    Margin="5,4,5,5"
                                                                    VerticalAlignment="Center"
                                                                    Text="Type:" />
                                                                <StackPanel Margin="5" Orientation="Vertical">
                                                                    <RadioButton
                                                                        Content="Body [B]"
                                                                        GroupName="ConstraintType"
                                                                        IsChecked="{Binding BodyConstraintTypeRadioButton_IsChecked}" />
                                                                    <RadioButton
                                                                        Content="Equal [E]"
                                                                        GroupName="ConstraintType"
                                                                        IsChecked="{Binding EqualConstraintTypeRadioButton_IsChecked}" />
                                                                    <RadioButton
                                                                        Content="Local [L]"
                                                                        GroupName="ConstraintType"
                                                                        IsChecked="{Binding LocalConstraintTypeRadioButton_IsChecked}" />
                                                                </StackPanel>
                                                                <Rectangle
                                                                    Width="1"
                                                                    Margin="0,2,0,5"
                                                                    VerticalAlignment="Stretch"
                                                                    Stroke="LightGray" />
                                                                <StackPanel
                                                                    Width="40"
                                                                    Margin="5"
                                                                    Orientation="Vertical">
                                                                    <CheckBox Content="{Binding U1CheckBox_Label}" IsChecked="{Binding U1CheckBox_IsChecked}" />
                                                                    <CheckBox Content="{Binding U2CheckBox_Label}" IsChecked="{Binding U2CheckBox_IsChecked}" />
                                                                    <CheckBox Content="{Binding U3CheckBox_Label}" IsChecked="{Binding U3CheckBox_IsChecked}" />
                                                                </StackPanel>
                                                                <StackPanel
                                                                    Width="40"
                                                                    Margin="5"
                                                                    Orientation="Vertical">
                                                                    <CheckBox Content="{Binding R1CheckBox_Label}" IsChecked="{Binding R1CheckBox_IsChecked}" />
                                                                    <CheckBox Content="{Binding R2CheckBox_Label}" IsChecked="{Binding R2CheckBox_IsChecked}" />
                                                                    <CheckBox Content="{Binding R3CheckBox_Label}" IsChecked="{Binding R3CheckBox_IsChecked}" />
                                                                </StackPanel>
                                                            </StackPanel>
                                                        </DockPanel>
                                                    </Border>
                                                    <Button
                                                        x:Name="BreakFrameClosestPointButton"
                                                        Width="200"
                                                        Click="BreakFrameClosestPointButton_Click"
                                                        Content="Break at Closest Point"
                                                        IsEnabled="{Binding BreakFrameClosestPointButton_IsEnabled}" />

                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Vertical">
                            <GroupBox
                                Margin="5"
                                Header="Substitute"
                                Style="{DynamicResource Blue_GroupBox}">
                                <GroupBox Header="Links to Frames">
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Foreground="DimGray" TextWrapping="Wrap">
                                            <Run Text="Selected links will be converted to a new frame with the selected frame section." />
                                            <LineBreak />
                                            <Run Text="The splice frames will be added to group AutoSplice." />
                                        </TextBlock>
                                        <Grid Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock
                                                Margin="0,0,5,0"
                                                VerticalAlignment="Center"
                                                Text="Section:" />
                                            <ComboBox
                                                x:Name="ManipulateItems_Substitute_LinksToFrames_FrameSection"
                                                Grid.Column="1"
                                                ItemsSource="{Binding Global_FrameSections_Available}"
                                                SelectedItem="{Binding ManipulateItemsSubstitute_LinksToFrames_SelectedFrameSection}" />
                                        </Grid>
                                        <Button
                                            x:Name="ManipulateItems_Substitute_LinksToFrames_Button"
                                            Width="100"
                                            Margin="5,0"
                                            Click="ManipulateItems_Substitute_LinksToFrames_Button_Click"
                                            Content="Links to Frames" />
                                    </StackPanel>
                                </GroupBox>
                            </GroupBox>
                        </StackPanel>
                    </Grid>
                </TabItem>
                <TabItem Header="Staged Construction" IsEnabled="{Binding SapAvailableIsEnabled}">
                    <DockPanel x:Name="StagedConstruction_TabItem_Panel">
                        <GroupBox
                            DockPanel.Dock="Top"
                            Header="Select Excel File"
                            Style="{DynamicResource Blue_GroupBox}">
                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                <Button
                                    Width="60"
                                    Margin="0,0,5,0"
                                    Command="{Binding SelectExcelFileButtonCommand}"
                                    Content="Browse" />
                                <TextBlock
                                    Width="Auto"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center"
                                    FontFamily="Courier New"
                                    Style="{DynamicResource TriStateTag_TextBlock}"
                                    Tag="{Binding ExcelFileStatus}"
                                    Text="{Binding ExcelFileName}" />
                                <TextBlock
                                    x:Name="StagedSelectExcelFilenameTextBlock"
                                    Width="Auto"
                                    VerticalAlignment="Center"
                                    Text="{Binding ExcelFileName}" />
                            </StackPanel>
                        </GroupBox>
                        <GroupBox
                            Width="200"
                            HorizontalAlignment="Center"
                            DockPanel.Dock="Right"
                            Header="Tools"
                            Style="{DynamicResource Blue_GroupBox}">
                            <StackPanel HorizontalAlignment="Stretch" Orientation="Vertical">
                                <GroupBox
                                    Header="Select Steps"
                                    IsEnabled="{Binding ExcelFile_IsOk}"
                                    Style="{DynamicResource CenterHeader_GroupBox}">
                                    <StackPanel HorizontalAlignment="Stretch" Orientation="Vertical">
                                        <TextBlock TextWrapping="Wrap">Select all elements of the groups related to the steps in the range.</TextBlock>
                                        <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                            <TextBlock Margin="5">Range:</TextBlock>
                                            <TextBox
                                                Width="50"
                                                Margin="0,5"
                                                Text="{Binding SelectStepGroupText}" />
                                            <Button
                                                Margin="5"
                                                Padding="5,0"
                                                Command="{Binding SelectStepRangeButtonCommand}"
                                                Content="Select" />
                                        </StackPanel>
                                    </StackPanel>
                                </GroupBox>
                                <GroupBox Header="Parallel Ghost" Style="{DynamicResource CenterHeader_GroupBox}">
                                    <StackPanel Orientation="Vertical">
                                        <GroupBox Margin="0,0,0,3" Header="Options">
                                            <StackPanel Orientation="Vertical">
                                                <DockPanel Margin="0,0,0,5">
                                                    <TextBlock
                                                        Width="50"
                                                        DockPanel.Dock="Left"
                                                        Text="Group:" />
                                                    <TextBox Text="{Binding GhostOptions_GroupName}" ToolTip="The group to add all the newly-generated Parallel Ghost." />
                                                </DockPanel>
                                                <DockPanel Margin="0,0,0,5">
                                                    <TextBlock
                                                        Width="82"
                                                        DockPanel.Dock="Left"
                                                        Text="Stiff Red Axial:" />
                                                    <TextBox Text="{Binding GhostOptions_AxialReductionValue}" ToolTip="The axial reduction on the frame elements will be:" />
                                                </DockPanel>
                                                <DockPanel Margin="0,0,0,5">
                                                    <TextBlock
                                                        Width="82"
                                                        DockPanel.Dock="Left"
                                                        Text="Stiff Red Other:" />
                                                    <TextBox Text="{Binding GhostOptions_OthersReductionValue}" ToolTip="The others reduction on the frame elements will be:" />
                                                </DockPanel>
                                                <GroupBox>
                                                    <GroupBox.Header>
                                                        <CheckBox
                                                            x:Name="GhostStructureMakeOthersStifferCheckBox"
                                                            Content="Make Some Stiffer"
                                                            IsChecked="{Binding GhostOptions_MakeGroupStiffer}" />
                                                    </GroupBox.Header>
                                                    <StackPanel Orientation="Vertical">
                                                        <DockPanel Margin="0,0,0,5">
                                                            <TextBlock
                                                                Width="60"
                                                                DockPanel.Dock="Left"
                                                                Text="Multiplier:" />
                                                            <TextBox
                                                                IsEnabled="{Binding GhostOptions_MakeGroupStiffer}"
                                                                Text="{Binding GhostOptions_ReductionValue_GroupMult}"
                                                                ToolTip="Multiplier to be added onto the Stiff Red that will change the stiffness of the members of the selected group." />
                                                        </DockPanel>
                                                        <DockPanel>
                                                            <TextBlock
                                                                Width="40"
                                                                VerticalAlignment="Center"
                                                                DockPanel.Dock="Left"
                                                                Text="Group:" />
                                                            <ComboBox
                                                                IsEnabled="{Binding ElementName=GhostStructureMakeOthersStifferCheckBox, Path=IsChecked}"
                                                                ItemsSource="{Binding StifferComboBox_ViewItems}"
                                                                SelectedItem="{Binding StifferComboBox_SelectedItem}"
                                                                ToolTip="Group that contains the elements that will be stiffer." />
                                                        </DockPanel>
                                                    </StackPanel>
                                                </GroupBox>
                                                <CheckBox Content="Copy Cables as Frames" IsChecked="{Binding GhostOptions_AddCablesAsFrames}" />
                                            </StackPanel>
                                        </GroupBox>
                                        <Button
                                            Margin="5,0,5,5"
                                            Command="{Binding GenerateGhostButtonCommand}"
                                            Content="Generate Ghost"
                                            DockPanel.Dock="Bottom" />
                                    </StackPanel>
                                </GroupBox>
                                <Button
                                    Margin="0,20,0,0"
                                    Command="{Binding ClearAllLoadCasesAndCombosButtonCommand}"
                                    Content="Clear All Load Cases and Combs" />
                            </StackPanel>
                        </GroupBox>

                        <StackPanel
                            Grid.Column="0"
                            Width="180"
                            HorizontalAlignment="Stretch"
                            DockPanel.Dock="Left"
                            Orientation="Vertical">
                            <GroupBox
                                Header="Load Pattern ShortNames"
                                IsEnabled="{Binding ExcelFile_IsOk}"
                                Style="{DynamicResource CenterHeader_GroupBox}"
                                ToolTip="# in Lateral loads will be replaced by the direction value. Examples: W_0 W_45 W_90...">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="75" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Margin="0,0,5,0"
                                        Text="DEAD:"
                                        TextAlignment="Right" />
                                    <TextBox
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Text="{Binding DeadPatternName}" />
                                    <Separator
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="2" />
                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Margin="0,0,5,0"
                                        Text="LIVE:"
                                        TextAlignment="Right" />
                                    <TextBox
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        Text="{Binding LivePatternName}" />
                                    <Separator Grid.Row="3" Grid.ColumnSpan="2" />
                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        Margin="0,0,5,0"
                                        Text="STRAIN:"
                                        TextAlignment="Right" />
                                    <TextBox
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Text="{Binding StrainPatternName}" />
                                    <Separator Grid.Row="5" Grid.ColumnSpan="2" />
                                    <TextBlock
                                        Grid.Row="6"
                                        Grid.Column="0"
                                        Margin="0,0,5,0"
                                        Text="WIND:"
                                        TextAlignment="Right"
                                        ToolTip="Use the # character to signal where the angle directions will be. Note: The wind pattern names *MUST* have 3 numbers to designate the angle, such as 000, 045, 090, 180 ..." />
                                    <TextBox
                                        Grid.Row="6"
                                        Grid.Column="1"
                                        Text="{Binding WindPatternName}"
                                        ToolTip="Use the # character to signal where the angle directions will be. Note: The wind pattern names *MUST* have 3 numbers to designate the angle, such as 000, 045, 090, 180 ..." />
                                    <Separator Grid.Row="7" Grid.ColumnSpan="2" />
                                    <TextBlock
                                        Grid.Row="8"
                                        Grid.Column="0"
                                        Margin="0,0,5,0"
                                        Text="NOTIONAL:"
                                        TextAlignment="Right"
                                        ToolTip="Use the # character to signal where the directions will be. Note: The notional pattern names *MUST* be X and Y. The intermediate directions for angles such as 045 deg is automatically calculated." />
                                    <TextBox
                                        Grid.Row="8"
                                        Grid.Column="1"
                                        Text="{Binding NotionalPatternName}"
                                        ToolTip="Use the # character to signal where the directions will be. Note: The notional pattern names *MUST* be X and Y. The intermediate directions for angles such as 045 deg is automatically calculated." />
                                    <Separator Grid.Row="9" Grid.ColumnSpan="2" />
                                    <TextBlock
                                        Grid.Row="10"
                                        Grid.Column="0"
                                        Margin="0,0,5,0"
                                        Text="TEMP:"
                                        TextAlignment="Right"
                                        ToolTip="Use the # character to signal where the plus or minus will be. Note: The temperature pattern names *MUST* be + and -." />
                                    <TextBox
                                        Grid.Row="10"
                                        Grid.Column="1"
                                        Text="{Binding TempPatternName}"
                                        ToolTip="Use the # character to signal where the plus or minus will be. Note: The temperature pattern names *MUST* be + and -." />
                                </Grid>
                            </GroupBox>
                            <StackPanel
                                HorizontalAlignment="Stretch"
                                IsEnabled="{Binding ExcelFile_IsOk}"
                                Orientation="Vertical">
                                <GroupBox Header="Cases to Create" Style="{DynamicResource CenterHeader_GroupBox}">
                                    <StackPanel Orientation="Vertical">
                                        <RadioButton
                                            Margin="9,0,0,0"
                                            Content="Dead Only"
                                            GroupName="CreateDeadStagedCases"
                                            IsChecked="{Binding DeadOnlyIsChecked}" />
                                        <GroupBox>
                                            <GroupBox.Header>
                                                <RadioButton
                                                    Content="Dead And ..."
                                                    GroupName="CreateDeadStagedCases"
                                                    IsChecked="{Binding DeadAndOthersIsChecked}" />
                                            </GroupBox.Header>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="8" />
                                                    <ColumnDefinition Width="62" />
                                                    <ColumnDefinition Width="10" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="10" />
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="10" />
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="10" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>
                                                <CheckBox
                                                    Grid.Row="0"
                                                    Grid.Column="0"
                                                    Grid.ColumnSpan="2"
                                                    Content="Wind"
                                                    IsChecked="{Binding WindIsChecked}"
                                                    IsEnabled="{Binding WindIsEnabled}" />
                                                <CheckBox
                                                    Grid.Row="1"
                                                    Grid.Column="0"
                                                    Grid.ColumnSpan="2"
                                                    Content="Notional"
                                                    IsChecked="{Binding NotionalIsChecked}"
                                                    IsEnabled="{Binding NotionalIsEnabled}" />
                                                <Border
                                                    Grid.Row="0"
                                                    Grid.RowSpan="2"
                                                    Grid.Column="2"
                                                    Margin="4,0"
                                                    HorizontalAlignment="Center"
                                                    BorderBrush="{DynamicResource EmsFaintBlueSolidBrush}"
                                                    BorderThickness="1,0,0,0" />
                                                <RadioButton
                                                    Grid.Row="0"
                                                    Grid.Column="3"
                                                    Content="At 45°s"
                                                    GroupName="LateralDirectionStagedCases"
                                                    IsChecked="{Binding At45IsChecked}"
                                                    IsEnabled="{Binding At45IsEnabled}" />
                                                <RadioButton
                                                    Grid.Row="1"
                                                    Grid.Column="3"
                                                    Content="At 90°s"
                                                    GroupName="LateralDirectionStagedCases"
                                                    IsChecked="{Binding At90IsChecked}"
                                                    IsEnabled="{Binding At90IsEnabled}" />
                                                <CheckBox
                                                    Grid.Row="3"
                                                    Grid.RowSpan="2"
                                                    Grid.Column="0"
                                                    Grid.ColumnSpan="2"
                                                    Margin="0,8"
                                                    VerticalAlignment="Center"
                                                    Content="Temp"
                                                    IsChecked="{Binding TemperatureIsChecked}"
                                                    IsEnabled="{Binding TemperatureIsEnabled}" />
                                                <Border
                                                    Grid.Row="3"
                                                    Grid.RowSpan="2"
                                                    Grid.Column="2"
                                                    Margin="4,0"
                                                    HorizontalAlignment="Center"
                                                    BorderBrush="{DynamicResource EmsFaintBlueSolidBrush}"
                                                    BorderThickness="1,0,0,0" />
                                                <CheckBox
                                                    Grid.Row="3"
                                                    Grid.Column="3"
                                                    Content="W/BD"
                                                    IsChecked="{Binding TempWithBaseDeadIsChecked}"
                                                    IsEnabled="{Binding TempWithBaseDeadIsEnabled}" />
                                                <CheckBox
                                                    Grid.Row="4"
                                                    Grid.Column="3"
                                                    Content="W/Lateral"
                                                    IsChecked="{Binding TempWithLateralIsChecked}"
                                                    IsEnabled="{Binding TempWithLateralIsEnabled}" />
                                                <CheckBox
                                                    Grid.Row="6"
                                                    Grid.Column="0"
                                                    Grid.ColumnSpan="4"
                                                    Content="Loads Remove stages"
                                                    IsChecked="{Binding LoadRemoveStagesIsChecked}"
                                                    IsEnabled="{Binding LoadRemoveStagesIsEnabled}"
                                                    ToolTip="Create these other load cases for the stages with remove actions?" />
                                                <StackPanel
                                                    Grid.Row="8"
                                                    Grid.Column="0"
                                                    Grid.ColumnSpan="4"
                                                    Orientation="Horizontal">
                                                    <CheckBox
                                                        Margin="0,0,5,0"
                                                        VerticalAlignment="Center"
                                                        Content="Red Wind?"
                                                        IsChecked="{Binding ReducedWindIsChecked}"
                                                        ToolTip="*Before* the given step, the wind loads will have a _RED at the end." />
                                                    <TextBox
                                                        Width="50"
                                                        IsEnabled="{Binding ReducedWind_Threshold_IsEnabled}"
                                                        Text="{Binding ReducedWind_Threshold}"
                                                        ToolTip="*Before* the given step, the wind loads will have a _RED at the end. GIVEN NUMBER IS INCLUDED IN THE _RED PART." />
                                                </StackPanel>
                                            </Grid>
                                        </GroupBox>
                                    </StackPanel>
                                </GroupBox>
                                <GroupBox
                                    Margin="0,10,0,0"
                                    Header="Generate Load Cases"
                                    Style="{DynamicResource CenterHeader_GroupBox}">
                                    <StackPanel Orientation="Vertical">
                                        <CheckBox
                                            Margin="5"
                                            Content="Event-to-Event Stepping"
                                            IsChecked="{Binding StagedCreateCasesMakeWithEventToEventStepping}"
                                            ToolTip="The Generated Load Cases Will be Set to Use Event-to-Event Stepping?" />
                                        <CheckBox
                                            Margin="5,0,5,5"
                                            Content="Combos"
                                            IsChecked="{Binding StagedCreateCasesMakeTheirDesignCombos}"
                                            ToolTip="Generate Their Design Combos?" />
                                        <Button
                                            Width="140"
                                            Command="{Binding GenerateLoadCasesButtonCommand}"
                                            Content="Generate Load Cases"
                                            ToolTip="* Will Delete All Load Cases and Combos From the Model *" />
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </StackPanel>

                        <GroupBox
                            Grid.Column="1"
                            Header="Excel Captured Data"
                            Style="{DynamicResource Blue_GroupBox}"
                            ToolTip="Read-Only - Changes the loaded excel file will refresh this table.">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="5" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <DataGrid
                                    Grid.Row="0"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    CanUserDeleteRows="False"
                                    CanUserReorderColumns="False"
                                    CanUserResizeColumns="False"
                                    CanUserResizeRows="False"
                                    CanUserSortColumns="False"
                                    IsEnabled="{Binding ExcelFile_IsOk}"
                                    IsReadOnly="True"
                                    ItemsSource="{Binding SCStepsDataGrid_ViewItems}"
                                    SelectionMode="Single">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn
                                            Width="0.3*"
                                            Binding="{Binding Order, StringFormat=D}"
                                            Header="Order">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding GroupName}"
                                            Header="Group ShortName">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding NamedProp}"
                                            Header="ShortNamed Property">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Operation}"
                                            Header="Operation">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <GridSplitter
                                    Grid.Row="1"
                                    HorizontalAlignment="Stretch"
                                    ResizeDirection="Rows" />
                                <DataGrid
                                    Grid.Row="2"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    CanUserDeleteRows="False"
                                    CanUserReorderColumns="False"
                                    CanUserResizeColumns="False"
                                    CanUserResizeRows="False"
                                    CanUserSortColumns="False"
                                    IsReadOnly="True"
                                    ItemsSource="{Binding SCCasesDataGrid_ViewItems}"
                                    SelectionMode="Single">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn
                                            Width="2.5*"
                                            Binding="{Binding Name}"
                                            Header="Case ShortName">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding DeadMult, StringFormat=F2}"
                                            Header="Dead">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding LiveMult, StringFormat=F2}"
                                            Header="Live">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding WindMult, StringFormat=F2}"
                                            Header="Wind">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding NotionalMult, StringFormat=F2}"
                                            Header="Not.">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding TemperatureMult, StringFormat=F2}"
                                            Header="Temp.">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding StrainMult, StringFormat=F2}"
                                            Header="Strain">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="2.5*"
                                            Binding="{Binding BaseName}"
                                            Header="Base ShortName">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridCheckBoxColumn
                                            Width="0.7*"
                                            Binding="{Binding Active}"
                                            Header="Active" />
                                        <DataGridTextColumn
                                            Width="0.7*"
                                            Binding="{Binding Others}"
                                            Header="Other">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </GroupBox>
                    </DockPanel>
                </TabItem>
                <TabItem Header="Run Cases" IsEnabled="{Binding SapAvailableIsEnabled}">
                    <Grid x:Name="RunCases_TabItem_Panel">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="300" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="400" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="300" />
                        </Grid.ColumnDefinitions>
                        <GroupBox
                            x:Name="NonLinearCases_GroupBox"
                            Grid.Row="0"
                            Grid.RowSpan="2"
                            Grid.Column="0"
                            Header="Non-Linear Cases Solver Options"
                            Style="{DynamicResource Blue_GroupBox}">
                            <DockPanel>
                                <Grid DockPanel.Dock="Top">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Button
                                        Grid.Column="0"
                                        HorizontalAlignment="Stretch"
                                        Command="{Binding GetNlCasesButtonCommand}"
                                        Content="Get NL Cases List" />
                                    <CheckBox
                                        Grid.Column="1"
                                        Margin="5,0,0,0"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Content="Only Failed"
                                        IsChecked="{Binding OnlyFailed_IsChecked}" />
                                    <TextBlock
                                        Grid.Column="2"
                                        Margin="10,0,5,0"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Text="RegEx Filter:" />
                                    <TextBox
                                        Grid.Column="3"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        Text="{Binding RegExFilter_Text, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                                <Grid DockPanel.Dock="Bottom" IsEnabled="{Binding SelectedCase_IsEnabled}">
                                    <GroupBox
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        DockPanel.Dock="Top"
                                        Header="{Binding SelectedCase.Name, FallbackValue='Select Case'}"
                                        Style="{DynamicResource CenterHeader_GroupBox}">
                                        <DockPanel>
                                            <DockPanel.Resources>
                                                <Style TargetType="TextBox">
                                                    <Setter Property="Margin" Value="0,1,0,1" />
                                                    <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                </Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="HorizontalAlignment" Value="Right" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="Margin" Value="0,0,5,0" />
                                                </Style>
                                                <Style TargetType="CheckBox">
                                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                </Style>
                                            </DockPanel.Resources>
                                            <GroupBox DockPanel.Dock="Top" Header="Solver Params">
                                                <Grid VerticalAlignment="Center">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="1*" />
                                                        <ColumnDefinition Width="0.3*" />
                                                        <ColumnDefinition Width="0.05*" />
                                                        <ColumnDefinition Width="1*" />
                                                        <ColumnDefinition Width="0.3*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Text="Max. Total Steps:"
                                                        ToolTip="Maximum Total Steps Per Stage" />
                                                    <TextBox
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.MaxTotalSteps},
                                                                                 ValRule=IntValRule|1}"
                                                        ToolTip="Maximum Total Steps Per Stage" />
                                                    <TextBlock
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Text="Max. Failed Substeps:"
                                                        ToolTip="Maximum Null (Zero) Steps Per Stage" />
                                                    <TextBox
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.MaxFailedSubSteps},
                                                                                 ValRule=IntValRule|1}"
                                                        ToolTip="Maximum Null (Zero) Steps Per Stage" />
                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Text="Max. CS per Step:"
                                                        ToolTip="Maximum Constant-Stiff Iterations Per Step" />
                                                    <TextBox
                                                        Grid.Row="2"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.MaxIterCS},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Maximum Constant-Stiff Iterations Per Step" />
                                                    <TextBlock
                                                        Grid.Row="3"
                                                        Grid.Column="0"
                                                        Text="Max. NR per Step:"
                                                        ToolTip="Maximum Newton-Raphson Iterations Per Step" />
                                                    <TextBox
                                                        Grid.Row="3"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.MaxIterNR},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Maximum Newton-Raphson Iterations Per Step" />
                                                    <TextBlock
                                                        Grid.Row="4"
                                                        Grid.Column="0"
                                                        Text="Convergence Tol.:"
                                                        ToolTip="Iteration Convergence Tolerance (Relative)" />
                                                    <TextBox
                                                        Grid.Row="4"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.TolConvD},
                                                                                 ValRule=DoubleValRule|0.0}"
                                                        ToolTip="Iteration Convergence Tolerance (Relative)" />
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="3"
                                                        Text="Event Stepping:"
                                                        ToolTip="Use Event-To-Event Stepping" />
                                                    <CheckBox
                                                        Grid.Row="0"
                                                        Grid.Column="4"
                                                        IsChecked="{Binding SelectedCase.SolControlParams.UseEventStepping}"
                                                        ToolTip="Use Event-To-Event Stepping" />
                                                    <TextBlock
                                                        Grid.Row="1"
                                                        Grid.Column="3"
                                                        Text="Event Tol.:"
                                                        ToolTip="Event Lumping Tolerance (Relative)" />
                                                    <TextBox
                                                        Grid.Row="1"
                                                        Grid.Column="4"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.TolEventD},
                                                                                 ValRule=DoubleValRule|0.0}"
                                                        ToolTip="Event Lumping Tolerance (Relative)" />
                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="3"
                                                        Text="Max. Line Search:"
                                                        ToolTip="Max Line Searches per Iteration" />
                                                    <TextBox
                                                        Grid.Row="2"
                                                        Grid.Column="4"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.MaxLineSearchPerIter},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Max Line Searches per Iteration" />
                                                    <TextBlock
                                                        Grid.Row="3"
                                                        Grid.Column="3"
                                                        Text="Line-Search Tol.:"
                                                        ToolTip="Line-Search Acceptance Tol. (Relative)" />
                                                    <TextBox
                                                        Grid.Row="3"
                                                        Grid.Column="4"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.TolLineSearch},
                                                                                 ValRule=DoubleValRule|0.0}"
                                                        ToolTip="Line-Search Acceptance Tol. (Relative)" />
                                                    <TextBlock
                                                        Grid.Row="4"
                                                        Grid.Column="3"
                                                        Text="LS Step Factor.:"
                                                        ToolTip="Line-Search Step Factor" />
                                                    <TextBox
                                                        Grid.Row="4"
                                                        Grid.Column="4"
                                                        Text="{ev:BindValidation {Binding SelectedCase.SolControlParams.LineSearchStepFact},
                                                                                 ValRule=DoubleValRule|0.0}"
                                                        ToolTip="Line-Search Step Factor" />
                                                </Grid>
                                            </GroupBox>
                                            <GroupBox DockPanel.Dock="Top" Header="Target Force Params">
                                                <Grid VerticalAlignment="Top">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="1*" />
                                                        <ColumnDefinition Width="0.3*" />
                                                        <ColumnDefinition Width="0.05*" />
                                                        <ColumnDefinition Width="1*" />
                                                        <ColumnDefinition Width="0.3*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Text="Max Iter. Per Stage:"
                                                        ToolTip="Maximum Iterations Per Stage" />
                                                    <TextBox
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.TargetForceParams.MaxIter},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Maximum Iterations Per Stage" />
                                                    <TextBlock
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Text="Convergence Tol. (Rel.)"
                                                        ToolTip="Convergence Tolerance (Relative)" />
                                                    <TextBox
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.TargetForceParams.TolConvF},
                                                                                 ValRule=DoubleValRule|0.0}"
                                                        ToolTip="Convergence Tolerance (Relative)" />
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="3"
                                                        Text="Acceleration Factor:"
                                                        ToolTip="Acceleration Factor" />
                                                    <TextBox
                                                        Grid.Row="0"
                                                        Grid.Column="4"
                                                        Text="{ev:BindValidation {Binding SelectedCase.TargetForceParams.AccelFact},
                                                                                 ValRule=DoubleValRule|0.0}"
                                                        ToolTip="Acceleration Factor" />
                                                    <TextBlock
                                                        Grid.Row="1"
                                                        Grid.Column="3"
                                                        Text="Continue if NOT Conv.:"
                                                        ToolTip="Continue Analysis if no Convergence" />
                                                    <CheckBox
                                                        Grid.Row="1"
                                                        Grid.Column="4"
                                                        IsChecked="{Binding SelectedCase.TargetForceParams.NoStop}"
                                                        ToolTip="Continue Analysis if no Convergence" />
                                                </Grid>
                                            </GroupBox>
                                            <GroupBox DockPanel.Dock="Top" Header="Save Params">
                                                <Grid VerticalAlignment="Center">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="0.7*" />
                                                        <ColumnDefinition Width="40" />
                                                        <ColumnDefinition Width=".05*" />
                                                        <ColumnDefinition Width=".7*" />
                                                        <ColumnDefinition Width="100" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Grid.ColumnSpan="2"
                                                        HorizontalAlignment="Center"
                                                        Foreground="ForestGreen"
                                                        Text="For NL Cases"
                                                        TextDecorations="Underline"
                                                        ToolTip="The options below will be applied to all of the selected cases that are regular Non-Linear." />
                                                    <TextBlock
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Text="Minimum:"
                                                        ToolTip="Minimum Number of Saved States - Set One to 0 to Save Only at Final State." />
                                                    <TextBox
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Width="40"
                                                        HorizontalAlignment="Left"
                                                        Text="{ev:BindValidation {Binding SelectedCase.ResultsSavedNL.MinSavedStates},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Minimum Number of Saved States - Set One to 0 to Save Only at Final State." />
                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Text="Maximum:"
                                                        ToolTip="Maximum Number of Saved States - Set One to 0 to Save Only at Final State." />
                                                    <TextBox
                                                        Grid.Row="2"
                                                        Grid.Column="1"
                                                        Text="{ev:BindValidation {Binding SelectedCase.ResultsSavedNL.MaxSavedStates},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Maximum Number of Saved States - Set One to 0 to Save Only at Final State." />
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="3"
                                                        Grid.ColumnSpan="2"
                                                        HorizontalAlignment="Center"
                                                        Foreground="ForestGreen"
                                                        Text="For Staged Cases"
                                                        TextDecorations="Underline"
                                                        ToolTip="The options below will be applied to all of the selected cases that are Staged Construction Multi-Step." />
                                                    <TextBlock
                                                        Grid.Row="1"
                                                        Grid.Column="3"
                                                        Text="Save At:"
                                                        ToolTip="Select When to Save the Results." />
                                                    <ComboBox
                                                        Grid.Row="1"
                                                        Grid.Column="4"
                                                        Height="20"
                                                        DisplayMemberPath="Text"
                                                        ItemsSource="{Binding SelectedCase.StagedSavedAtOptions, Mode=OneWay}"
                                                        SelectedValue="{Binding SelectedCase.ResultsSavedStaged.StagedSaveOption}"
                                                        SelectedValuePath="EnumVal" />
                                                    <TextBlock
                                                        Grid.Row="2"
                                                        Grid.Column="3"
                                                        Text="Min. App Load:"
                                                        ToolTip="Minimum Number of Steps for Application of Instantaneous Load." />
                                                    <TextBox
                                                        Grid.Row="2"
                                                        Grid.Column="4"
                                                        Text="{ev:BindValidation {Binding SelectedCase.ResultsSavedStaged.StagedMinSteps},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Minimum Number of Steps for Application of Instantaneous Load." />
                                                    <TextBlock
                                                        Grid.Row="3"
                                                        Grid.Column="3"
                                                        Text="Min for Time Dep.:"
                                                        ToolTip="Minimum Number of Steps for Analysis of Time Dependent Items." />
                                                    <TextBox
                                                        Grid.Row="3"
                                                        Grid.Column="4"
                                                        Text="{ev:BindValidation {Binding SelectedCase.ResultsSavedStaged.StagedMinStepsTD},
                                                                                 ValRule=IntValRule|0}"
                                                        ToolTip="Minimum Number of Steps for Analysis of Time Dependent Items." />
                                                </Grid>
                                            </GroupBox>
                                            <StackPanel DockPanel.Dock="Top" Orientation="Vertical">
                                                <Button
                                                    Width="150"
                                                    Height="20"
                                                    Margin="0,10,0,0"
                                                    Command="{Binding UpdateSelectedCasesButtonCommand}"
                                                    Content="Update Selected Cases" />
                                                <Button
                                                    Width="240"
                                                    Height="20"
                                                    Margin="0,10,0,0"
                                                    Command="{Binding AddModalToSelectedCasesButtonCommand}"
                                                    Content="Add Modal Starting from Selected Cases" />

                                            </StackPanel>
                                        </DockPanel>
                                    </GroupBox>
                                </Grid>
                                <DataGrid
                                    Margin="0,5,0,0"
                                    ec:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding NonLinearCasesSolverDataGrid_Selected}"
                                    AutoGenerateColumns="False"
                                    CanUserResizeColumns="False"
                                    IsReadOnly="True"
                                    ItemsSource="{Binding NonLinearCasesSolverDataGrid_ViewItems}"
                                    ScrollViewer.VerticalScrollBarVisibility="Visible"
                                    SelectionMode="Extended">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Name}"
                                            Header="Case ShortName">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Left" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn
                                            Width="100"
                                            Binding="{Binding Status}"
                                            Header="Status">
                                            <DataGridTextColumn.CellStyle>
                                                <Style>
                                                    <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                </Style>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>
                                        <DataGridCheckBoxColumn
                                            Width="40"
                                            Binding="{Binding RunFlag}"
                                            Header="Run?" />
                                    </DataGrid.Columns>
                                </DataGrid>

                            </DockPanel>
                        </GroupBox>
                        <GroupBox
                            x:Name="LoadCasesGeneralAction_GroupBox"
                            Grid.RowSpan="5"
                            Grid.Column="2"
                            Header="General Actions"
                            Style="{DynamicResource Blue_GroupBox}">
                            <StackPanel Orientation="Vertical">
                                <GroupBox Header="Intermediate Steps">
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock
                                            Margin="4"
                                            Style="{DynamicResource Explanation_TextBlock}"
                                            Text="Will configure the cases listed on the clipboard to have the desired number of intermediate steps."
                                            TextWrapping="Wrap" />
                                        <StackPanel
                                            Margin="5,0"
                                            HorizontalAlignment="Center"
                                            Orientation="Horizontal">
                                            <TextBlock Margin="0,0,5,0" Text="Number of Steps:" />
                                            <TextBox Width="50" Text="{ev:BindValidation {Binding IntermediateNumberOfSteps}, ValRule=IntValRule|0}" />
                                        </StackPanel>
                                        <Button
                                            Width="130"
                                            Margin="5"
                                            Command="{Binding AddIntermediateStepsToCasesInClipboardButtonCommand}"
                                            Content="Set Intermediate Steps" />
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </TabItem>
                <TabItem Header="Rename" IsEnabled="{Binding SapAvailableIsEnabled}">
                    <StackPanel x:Name="Rename_TabItem_Panel" Orientation="Horizontal">
                        <StackPanel
                            Width="300"
                            DockPanel.Dock="Left"
                            Orientation="Vertical">
                            <GroupBox
                                Margin="5"
                                Header="Rename Items"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel
                                    Margin="5"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Top"
                                    Orientation="Vertical">
                                    <StackPanel
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <TextBlock Margin="0,0,0,5" VerticalAlignment="Center">Start From:</TextBlock>
                                        <TextBox
                                            Width="50"
                                            Margin="5,0,0,5"
                                            VerticalAlignment="Center"
                                            Text="{Binding StartCountValue}" />
                                        <RadioButton
                                            Margin="30,0,5,5"
                                            VerticalAlignment="Center"
                                            Content="All"
                                            GroupName="RenameAllFromValueAll"
                                            IsChecked="{Binding RenameAllIsChecked}" />
                                        <RadioButton
                                            Margin="0,0,0,5"
                                            VerticalAlignment="Center"
                                            Content="Selection Only"
                                            GroupName="RenameAllFromValueAll"
                                            IsChecked="{Binding RenameSelectedIsChecked}" />
                                    </StackPanel>
                                    <Button
                                        x:Name="RenameFromValueButton"
                                        Click="RenameFromValueButton_Click"
                                        Content="Rename Items Sequentially From Given Number" />
                                    <Grid Margin="0,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width=".5*" />
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Row="0" Orientation="Vertical">
                                            <TextBlock>
                                                <Run Text="Largest Point #: " />
                                                <Run Text="{Binding LargestPoint}" />
                                            </TextBlock>
                                            <TextBlock>
                                                <Run Text="Largest Frame #: " />
                                                <Run Text="{Binding LargestFrame}" />
                                            </TextBlock>
                                        </StackPanel>
                                        <Button
                                            x:Name="RenameGetMaxBNumberButton"
                                            Grid.Column="1"
                                            Width="70"
                                            Height="20"
                                            Click="RenameGetMaxBNumberButton_Click"
                                            Content="Get Max" />
                                    </Grid>
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                Margin="5"
                                Header="Remove Regex From All ShortNames"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel
                                    Margin="5"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Top"
                                    Orientation="Vertical">
                                    <StackPanel
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Orientation="Horizontal">
                                        <TextBlock Margin="0,0,0,5" VerticalAlignment="Center">Regex:</TextBlock>
                                        <TextBox
                                            Width="70"
                                            Margin="5,0,0,5"
                                            VerticalAlignment="Center"
                                            Text="{Binding RegexToFind}" />
                                        <RadioButton
                                            Margin="10,0,5,5"
                                            VerticalAlignment="Center"
                                            Content="To Rand"
                                            GroupName="RenameRemoveRegexGroup"
                                            IsChecked="{Binding RegexRenameToRand}" />
                                        <RadioButton
                                            Margin="0,0,0,5"
                                            VerticalAlignment="Center"
                                            Content="Just Remove"
                                            GroupName="RenameRemoveRegexGroup"
                                            IsChecked="{Binding RegexJustRemoveRegex}" />
                                    </StackPanel>
                                    <Button
                                        x:Name="RenameRemoveRegexButton"
                                        Click="RenameRemoveRegexButton_Click"
                                        Content="Find Regex And Rename" />
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        Foreground="DarkGray"
                                        Text="Current version only renames frames and joints." />
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                    </StackPanel>
                </TabItem>
                <TabItem Header="Selection" IsEnabled="{Binding SapAvailableIsEnabled}">
                    <DockPanel x:Name="Selection_TabItem_Panel">
                        <Border
                            Width="300"
                            BorderBrush="DarkGray"
                            BorderThickness="1,0,0,0"
                            DockPanel.Dock="Right">

                            <GroupBox Header="Misc">
                                <StackPanel Orientation="Vertical">
                                    <StackPanel Orientation="Vertical">
                                        <Border
                                            Margin="3"
                                            BorderBrush="DeepSkyBlue"
                                            BorderThickness="1,1,1,1"
                                            CornerRadius="5">
                                            <StackPanel Orientation="Vertical">
                                                <TextBlock
                                                    Margin="5"
                                                    HorizontalAlignment="Center"
                                                    TextAlignment="Center"
                                                    TextWrapping="Wrap">
                                                    <Run Foreground="DarkSlateBlue" Text="Select a list of elements whose names are on the clipboard.The names must be separated by lines, tabs or from Excel." />
                                                </TextBlock>
                                                <UniformGrid Margin="5,0,5,5" Columns="3">
                                                    <CheckBox Content="Joints" IsChecked="{Binding SelectMisc_FromClipboard_JointIsChecked}" />
                                                    <CheckBox Content="Frames" IsChecked="{Binding SelectMisc_FromClipboard_FrameIsChecked}" />
                                                    <CheckBox Content="Areas" IsChecked="{Binding SelectMisc_FromClipboard_AreaIsChecked}" />
                                                    <CheckBox Content="Cables" IsChecked="{Binding SelectMisc_FromClipboard_CableIsChecked}" />
                                                    <CheckBox Content="Links" IsChecked="{Binding SelectMisc_FromClipboard_LinkIsChecked}" />
                                                </UniformGrid>
                                                <Button
                                                    x:Name="SelectMisc_FromClipboard_Button"
                                                    Width="100"
                                                    Margin="0,0,0,5"
                                                    Click="SelectMisc_FromClipboard_Button_Click"
                                                    Content="Select" />
                                            </StackPanel>

                                        </Border>
                                    </StackPanel>
                                    <StackPanel Orientation="Vertical">
                                        <Border
                                            Margin="3"
                                            BorderBrush="DeepSkyBlue"
                                            BorderThickness="1,1,1,1"
                                            CornerRadius="5">
                                            <StackPanel Orientation="Vertical">
                                                <TextBlock
                                                    Margin="5"
                                                    HorizontalAlignment="Center"
                                                    TextAlignment="Center"
                                                    TextWrapping="Wrap">
                                                    <Run Foreground="DarkSlateBlue" Text="Selects the frames based on their lengths." />
                                                </TextBlock>
                                                <CheckBox
                                                    HorizontalAlignment="Center"
                                                    Content="Filter from Selection"
                                                    IsChecked="{Binding SelectMisc_FramesBasedOnLength_FilterFromSelection}" />
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Margin="5"
                                                        VerticalAlignment="Center"
                                                        Text="Max Length:" />
                                                    <TextBox
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Margin="5"
                                                        VerticalAlignment="Center"
                                                        Text="{Binding SelectMisc_FramesBasedOnLength_MaxLength}" />
                                                    <TextBlock
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Margin="5"
                                                        Text="Min Length:" />
                                                    <TextBox
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Margin="5"
                                                        Text="{Binding SelectMisc_FramesBasedOnLength_MinLength}" />
                                                </Grid>
                                                <Button
                                                    x:Name="SelectMisc_FramesBasedOnLength_Button"
                                                    Width="100"
                                                    Margin="0,0,0,5"
                                                    Click="SelectMisc_FramesBasedOnLength_Button_Click"
                                                    Content="Select" />
                                            </StackPanel>

                                        </Border>
                                    </StackPanel>
                                </StackPanel>

                            </GroupBox>

                        </Border>
                        <StackPanel Orientation="Vertical">
                            <StackPanel Orientation="Horizontal">
                                <CheckBox
                                    Margin="5"
                                    Checked="SelectionMonitorCheckBox_Checked"
                                    Content="Monitor Selection"
                                    IsChecked="{Binding SelectionMonitorEnabled}"
                                    Unchecked="SelectionMonitorCheckBox_Unchecked" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <GroupBox
                                    Width="300"
                                    Height="400"
                                    DockPanel.Dock="Left">
                                    <GroupBox.Header>
                                        <CheckBox Content="Groups" IsChecked="{Binding GetGroups}" />
                                    </GroupBox.Header>
                                    <DockPanel>
                                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                            <CheckBox
                                                Margin="3,0,5,0"
                                                VerticalAlignment="Center"
                                                Content="Include Points?"
                                                IsChecked="{Binding GroupIncludePoints}" />
                                            <TextBlock
                                                Margin="5"
                                                HorizontalAlignment="Center"
                                                Text="All groups of all selected items" />
                                        </StackPanel>
                                        <StackPanel DockPanel.Dock="Bottom" Orientation="Vertical">
                                            <TextBox Width="50" Text="{Binding STGWWeld}" />
                                            <Button
                                                x:Name="TempCanopy_AddAidWeldGrp_Button"
                                                Click="TempCanopy_AddAidWeldGrp_Button_Click"
                                                Content="Add Aid/Weld Group" />
                                            <Button
                                                x:Name="TempCanopy_RemoveAidWeldGrp_Button"
                                                Click="TempCanopy_RemoveAidWeldGrp_Button_Click"
                                                Content="Remove Aid/Weld Group" />
                                            <Button
                                                x:Name="MergeABGroups_Button"
                                                Margin="0,5,0,0"
                                                Click="MergeABGroups_Button_Click"
                                                Content="Merge AB Groups" />
                                            <Button
                                                x:Name="OnlyAGroup_Button"
                                                Click="OnlyAGroup_Button_Click"
                                                Content="Only A [Perimeter]" />
                                            <Button
                                                x:Name="OnlyBGroup_Button"
                                                Click="OnlyBGroup_Button_Click"
                                                Content="Only B [Module]" />
                                        </StackPanel>
                                        <DataGrid
                                            x:Name="SelMonitor_GroupsDataGrid"
                                            Grid.Row="0"
                                            HorizontalAlignment="Stretch"
                                            VerticalAlignment="Stretch"
                                            AutoGenerateColumns="False"
                                            CanUserAddRows="False"
                                            CanUserDeleteRows="False"
                                            CanUserReorderColumns="False"
                                            CanUserResizeColumns="False"
                                            CanUserResizeRows="False"
                                            CanUserSortColumns="False"
                                            IsEnabled="{Binding ExcelFile_IsOk}"
                                            IsReadOnly="True"
                                            ItemsSource="{Binding}"
                                            SelectionMode="Single">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn
                                                    Width="*"
                                                    Binding="{Binding GroupName}"
                                                    Header="Group ShortName">
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style>
                                                            <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn
                                                    Width="70"
                                                    Binding="{Binding ItemCount, StringFormat=D}"
                                                    Header="Item Count">
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style>
                                                            <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>

                                            </DataGrid.Columns>
                                        </DataGrid>

                                    </DockPanel>
                                </GroupBox>
                                <StackPanel Orientation="Vertical">
                                    <GroupBox
                                        Width="300"
                                        Height="200"
                                        DockPanel.Dock="Left">
                                        <GroupBox.Header>
                                            <CheckBox Content="Frames" IsChecked="{Binding GetFrames}" />
                                        </GroupBox.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="70" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="22" />
                                                <RowDefinition Height="22" />
                                                <RowDefinition Height="22" />
                                                <RowDefinition Height="22" />
                                                <RowDefinition Height="22" />
                                                <RowDefinition Height="22" />
                                            </Grid.RowDefinitions>

                                            <TextBlock
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="ShortName:" />
                                            <TextBox
                                                Grid.Row="0"
                                                Grid.Column="1"
                                                Margin="2"
                                                IsReadOnly="True"
                                                Text="{Binding Frame_Name}" />

                                            <TextBlock
                                                Grid.Row="1"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="Section:" />
                                            <TextBox
                                                Grid.Row="1"
                                                Grid.Column="1"
                                                Margin="2"
                                                IsReadOnly="True"
                                                Text="{Binding Frame_Section}" />

                                            <TextBlock
                                                Grid.Row="2"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="Length:" />
                                            <TextBox
                                                Grid.Row="2"
                                                Grid.Column="1"
                                                Margin="2"
                                                IsReadOnly="True"
                                                Text="{Binding Frame_Length}" />

                                            <TextBlock
                                                Grid.Row="3"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="Sel Point:" />
                                            <TextBox
                                                Grid.Row="3"
                                                Grid.Column="1"
                                                Margin="2"
                                                IsReadOnly="True"
                                                Text="{Binding Frame_PointText}" />
                                        </Grid>
                                    </GroupBox>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </DockPanel>
                </TabItem>
                <TabItem Header="Disney Canopy" IsEnabled="{Binding SapAvailableIsEnabled}">
                    <StackPanel x:Name="DisneySpecial_TabItem_Panel" Orientation="Horizontal">
                        <DockPanel Width="300">
                            <StackPanel Orientation="Vertical">
                                <GroupBox Header="Gets into Clipboard Curved Frame Definitions" Style="{DynamicResource Blue_GroupBox}">
                                    <DockPanel>
                                        <Button
                                            x:Name="DisneyGetCurvedFrameDefButton"
                                            Margin="5"
                                            Click="DisneyGetCurvedFrameDefButton_Click"
                                            Content="Get straight sections of the curved frames" />
                                    </DockPanel>
                                </GroupBox>
                                <GroupBox Header="Misc" Style="{DynamicResource Blue_GroupBox}">
                                    <DockPanel>
                                        <Button
                                            x:Name="UndoErectionAidSectionsButton"
                                            Margin="5"
                                            Click="UndoErectionAidSectionsButton_Click"
                                            Content="Turn Aid's sections to Full Sections" />
                                    </DockPanel>
                                </GroupBox>
                                <GroupBox Header="Rebuild Canopy Model From KH Info" Style="{DynamicResource Blue_GroupBox}">
                                    <StackPanel Orientation="Vertical">
                                        <Button
                                            x:Name="DisneyRebuildFromKHExcelButton"
                                            Margin="5"
                                            Click="DisneyRebuildFromKHExcelButton_Click"
                                            Content="Rebuild from KH Excel Data" />
                                        <Button
                                            x:Name="DisneyEnsureLGSUpwardsButton"
                                            Margin="5"
                                            Click="DisneyEnsureLGSUpwardsButton_Click"
                                            Content="Ensure LGS Axis Upwards" />
                                        <Button
                                            x:Name="DisneyFlipSelectedLGSAxisButton"
                                            Margin="5"
                                            Click="DisneyFlipSelectedLGSAxisButton_Click"
                                            Content="Flip LGS Axis" />
                                    </StackPanel>
                                </GroupBox>
                                <GroupBox Header="Join Basic Canopy With Constraints" Style="{DynamicResource Blue_GroupBox}">
                                    <StackPanel Margin="5" Orientation="Vertical">
                                        <Border BorderBrush="#FF5A609C" BorderThickness="1">
                                            <StackPanel Orientation="Vertical">
                                                <TextBlock
                                                    Margin="2"
                                                    Text="Action 1: Ensure that Upstands have on either end either a LGS or an UGS."
                                                    TextWrapping="Wrap" />
                                                <Button
                                                    x:Name="DisneyConstraintUpstandsButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintUpstandsButton_Click"
                                                    Content="Upstands" />
                                                <Button
                                                    x:Name="DisneyConstraintLowerGridshellButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintLowerGridshellButton_Click"
                                                    Content="Lower Gridshell" />
                                                <Button
                                                    x:Name="DisneyConstraintEdgeUpstandButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintEdgeUpstandButton_Click"
                                                    Content="Edge Upstands" />
                                                <Button
                                                    x:Name="DisneyConstraintUpperGridshellButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintUpperGridshellButton_Click"
                                                    Content="Upper Gridshell" />
                                                <Button
                                                    x:Name="DisneyConstraintPerimeterWebButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintPerimeterWebButton_Click"
                                                    Content="Perimeter Web" />
                                                <Button
                                                    x:Name="DisneyConstraintEndTrussBracingButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintEndTrussBracingButton_Click"
                                                    Content="EndTruss Bracings" />
                                                <Button
                                                    x:Name="DisneyConstraintRidgeButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintRidgeButton_Click"
                                                    Content="Ridge Beam" />
                                                <Button
                                                    x:Name="DisneyConstraintColumnsButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyConstraintColumnsButton_Click"
                                                    Content="Columns" />
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </GroupBox>
                                <GroupBox
                                    Margin="5"
                                    Header="Grab Old Data"
                                    Style="{DynamicResource Blue_GroupBox}">
                                    <StackPanel Margin="5" Orientation="Vertical">
                                        <Border BorderBrush="#FF5A609C" BorderThickness="1">
                                            <StackPanel Orientation="Vertical">
                                                <TextBlock
                                                    Margin="2"
                                                    Text="Grabbing the data from the old model."
                                                    TextWrapping="Wrap" />
                                                <Button
                                                    x:Name="DisneyCopyAidsInformationButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyCopyAidsInformationButton_Click"
                                                    Content="Copy Erection Aids" />
                                                <Button
                                                    x:Name="DisneyCopyGroupInformationButton"
                                                    Margin="30,0,30,5"
                                                    Click="DisneyCopyGroupInformationButton_Click"
                                                    Content="Copy Groups" />
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </DockPanel>
                        <StackPanel Width="350" Orientation="Vertical" />

                    </StackPanel>
                </TabItem>
                <TabItem Header="SQLite Operations">
                    <DockPanel x:Name="SQLiteOperations_TabItem_Panel">
                        <StackPanel
                            Width="300"
                            DockPanel.Dock="Left"
                            Orientation="Vertical">
                            <GroupBox
                                Margin="5"
                                Header="Select SQLite File to Work"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Margin="5,5,5,0" Orientation="Vertical">
                                    <WrapPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                        <Button
                                            x:Name="BrowseSQLiteForManipButton"
                                            Width="100"
                                            Margin="5,0"
                                            VerticalAlignment="Center"
                                            Click="BrowseSQLiteForManipButton_Click"
                                            Content="Browse SQLite" />
                                    </WrapPanel>
                                    <TextBlock
                                        Height="50"
                                        Margin="5"
                                        VerticalAlignment="Center"
                                        Text="{Binding SQLiteFileName}"
                                        TextWrapping="WrapWithOverflow" />
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                Margin="5"
                                Header="Convert S2K Tables to SQLite"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Orientation="Vertical">
                                    <Grid Margin="5,5,5,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="20" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Button
                                            x:Name="BrowseS2KForTableReadButton"
                                            Grid.Row="0"
                                            Width="100"
                                            VerticalAlignment="Center"
                                            Click="BrowseS2KForTableReadButton_Click"
                                            Content="Browse S2K" />
                                        <TextBlock
                                            Grid.Row="1"
                                            Height="50"
                                            Margin="5"
                                            VerticalAlignment="Center"
                                            Text="{Binding S2KFileName}"
                                            TextWrapping="WrapWithOverflow" />
                                    </Grid>
                                    <Button
                                        x:Name="ConvertS2KTablesToSQLiteButton"
                                        Width="150"
                                        Margin="20,0,20,5"
                                        Click="ConvertS2KTablesToSQLiteButton_Click"
                                        Content="Convert Tables to SQLite"
                                        IsEnabled="{Binding ConvertButton_IsEnabled}" />
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                Margin="5"
                                Header="Get Result Tables to SQLite"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Orientation="Vertical">
                                    <StackPanel Orientation="Vertical">
                                        <CheckBox
                                            Margin="5"
                                            Content="Element Forces - Frames"
                                            IsChecked="{Binding TableImportFramesForces_IsChecked}" />
                                    </StackPanel>
                                    <Button
                                        x:Name="GetSelectedResultTablesToSQLiteButton"
                                        Width="150"
                                        Margin="20,0,20,5"
                                        VerticalAlignment="Center"
                                        Click="GetSelectedResultTablesToSQLiteButton_Click"
                                        Content="Send Tables to SQLite" />
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                        <Grid />
                    </DockPanel>
                </TabItem>
                <TabItem Header="Rhino Operations">
                    <StackPanel x:Name="RhinoOperations_TabItem_Panel" Orientation="Horizontal">
                        <StackPanel Width="300" Orientation="Vertical">
                            <GroupBox
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Header="Align Joints To Rhino Surface"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock
                                        Margin="3"
                                        Foreground="Gray"
                                        TextWrapping="Wrap">
                                        <Run>Will project the points in SAP2000 group &quot;RhinoAlignPoints&quot; to the selected surface in Rhino6.</Run>
                                        <LineBreak />
                                        <Run>Rhino6 must be open and the surface must be selected.</Run>
                                    </TextBlock>
                                    <Button
                                        x:Name="AlignPointsToRhinoSurfaceButton"
                                        Margin="25,5,25,5"
                                        Click="AlignPointsToRhinoSurfaceButton_Click"
                                        Content="Align Points to Rhino6 Surface" />
                                    <Separator Margin="4" />
                                    <TextBlock
                                        Margin="3"
                                        Foreground="Gray"
                                        TextWrapping="Wrap">
                                        <Run>Will add the points in group &quot;RhinoAlignPoints&quot;, and their local axes' triads, to the currently open Rhino6 document.</Run>
                                    </TextBlock>
                                    <Button
                                        x:Name="AddPointsAndTriadsToRhinoButton"
                                        Margin="25,5,25,10"
                                        Click="AddPointsAndTriadsToRhinoButton_Click"
                                        Content="Add Points and Triads to Rhino" />
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                Header="Mark ShortNames in Clipboard"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock
                                        Margin="3"
                                        Foreground="Gray"
                                        TextWrapping="Wrap">
                                        <Run>Will get the list of elements' name from the Clipboard and:</Run>
                                        <LineBreak />
                                        <Run>1- Mark them in black for visual effects.</Run>
                                        <LineBreak />
                                        <Run>2- Put them in the following named Group.</Run>
                                    </TextBlock>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock
                                            Grid.Column="0"
                                            Margin="5"
                                            Text="Rhino Group:" />
                                        <TextBox
                                            Grid.Column="1"
                                            Margin="5"
                                            Text="{Binding TargetRhinoGroupForSelectedJoints}" />
                                    </Grid>
                                    <Button
                                        x:Name="MarkNamesInClipboardRhinoButton"
                                        Margin="25,5,25,10"
                                        Click="MarkNamesInClipboardRhinoButton_Click"
                                        Content="Mark Guids in Clipboard" />
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                    </StackPanel>
                </TabItem>
                <TabItem x:Name="TrussSolverTabItem" Header="Truss Solver">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <StackPanel
                            Grid.Row="0"
                            HorizontalAlignment="Center"
                            Orientation="Vertical">
                            <TextBlock
                                Margin="5"
                                Style="{DynamicResource Explanation_TextBlock}"
                                TextAlignment="Center">
                                <Run
                                    FontSize="16"
                                    Foreground="DimGray"
                                    TextDecorations="Underline">
                                    Truss Direct Analysis Limit Solver
                                </Run>
                            </TextBlock>
                            <Border Style="{DynamicResource DarkBlue_Border}">
                                <StackPanel Margin="10,5" Style="{DynamicResource ExplText_StackPanel}">
                                    <TextBlock>This tool will find the lateral displacement that will yield a maximum utilization ratio of 1.</TextBlock>
                                    <TextBlock>
                                        <Run TextDecorations="Underline">Attention:</Run>
                                        <Run>The model must be correctly configured for Direct Analysis.</Run>
                                    </TextBlock>

                                    <ListBox Foreground="{DynamicResource EmsExplanationSolidBrush}" Style="{DynamicResource Bullet_ListBox}">
                                        <ListBox.Items>
                                            <system:String>The Young's Modulus of the material properties must be reduced.</system:String>
                                            <system:String>The load case must be correctly set (with displacement control, control joint and DOF).</system:String>
                                            <system:String>The load combination must be defined. It MUST have the format &quot;C_load_case_name&quot;</system:String>
                                            <system:String>Everything concerning code check (global and overwrites) must be set.</system:String>
                                        </ListBox.Items>
                                    </ListBox>

                                </StackPanel>
                            </Border>
                        </StackPanel>
                        <Separator
                            Grid.Row="1"
                            Margin="5"
                            Foreground="LightGray"
                            Style="{DynamicResource H_Separator}" />
                        <DockPanel Grid.Row="2" VerticalAlignment="Stretch">
                            <GroupBox
                                DockPanel.Dock="Left"
                                Header="Control"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Width="250" Orientation="Vertical">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <TextBlock
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Margin="5,0"
                                            VerticalAlignment="Center"
                                            Text="Load Case:" />
                                        <ComboBox
                                            x:Name="TrusSolver_LoadCase_ComboBox"
                                            Grid.Row="0"
                                            Grid.Column="1"
                                            Margin="5,5"
                                            ItemsSource="{Binding Global_NonLinearCases_Available}"
                                            SelectedItem="{Binding TrussSolverLoadCase_Selected}"
                                            ToolTip="The load case that will be manipulated." />
                                        <TextBlock
                                            Grid.Row="1"
                                            Grid.Column="0"
                                            Margin="5,0"
                                            VerticalAlignment="Center"
                                            Text="Start Displ.:" />
                                        <TextBox
                                            Grid.Row="1"
                                            Grid.Column="1"
                                            Margin="5,5"
                                            Text="{Binding StartDisplacement}"
                                            ToolTip="The first displacement that will be analysed." />
                                        <TextBlock
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            Margin="5,0"
                                            VerticalAlignment="Center"
                                            Text="Start Step:" />
                                        <TextBox
                                            Grid.Row="2"
                                            Grid.Column="1"
                                            Margin="5,5"
                                            Text="{Binding StartStep}"
                                            ToolTip="The initial step for the displacement iteration. It will be halved for each step that fails." />
                                        <TextBlock
                                            Grid.Row="3"
                                            Grid.Column="0"
                                            Margin="5,0"
                                            VerticalAlignment="Center"
                                            Text="Target Ratio:" />
                                        <TextBox
                                            Grid.Row="3"
                                            Grid.Column="1"
                                            Margin="5,5"
                                            Text="{Binding TargetUtilizationRatio}"
                                            ToolTip="The target utilization ratio." />
                                        <TextBlock
                                            Grid.Row="4"
                                            Grid.Column="0"
                                            Margin="5,0"
                                            VerticalAlignment="Center"
                                            Text="Ratio Tol.:" />
                                        <TextBox
                                            Grid.Row="4"
                                            Grid.Column="1"
                                            Margin="5,5"
                                            Text="{Binding UtilizationRatioTolerance}"
                                            ToolTip="The tolerance that will be used to search for the ratio." />
                                    </Grid>
                                    <Button
                                        x:Name="TrussSolver_SolveButton"
                                        Width="150"
                                        Margin="5"
                                        Click="TrussSolver_SolveButton_Click"
                                        Content="Solve!" />
                                </StackPanel>
                            </GroupBox>
                            <ScrollViewer Margin="5" VerticalScrollBarVisibility="Visible">
                                <TextBox
                                    FontFamily="Courier New"
                                    Foreground="DimGray"
                                    IsReadOnly="True"
                                    Text="{Binding Report}" />
                            </ScrollViewer>
                        </DockPanel>
                    </Grid>
                </TabItem>
                <TabItem x:Name="CanopySurveyTabItem" Header="Canopy Survey">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <GroupBox Header="Results" Style="{DynamicResource Blue_GroupBox}">
                            <StackPanel Orientation="Vertical">
                                <GroupBox Margin="3,0,3,3" Header="Displacements">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="50" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock
                                            Grid.Row="0"
                                            Grid.ColumnSpan="100"
                                            Style="{DynamicResource Explanation_TextBlock}"
                                            TextWrapping="Wrap">
                                            <Run Text="Will output the displacements of the selected groups and the selected cases. Results will be for the last step." />
                                            <LineBreak />
                                            <Run Text="Current Units: " />
                                            <Run Text="{Binding CurrentUnits}" />
                                        </TextBlock>
                                        <TextBlock
                                            Grid.Row="1"
                                            Grid.Column="0"
                                            Margin="0,0,5,0"
                                            VerticalAlignment="Center"
                                            Text="Output Cases:"
                                            TextAlignment="Right"
                                            TextWrapping="Wrap" />
                                        <ListBox
                                            Grid.Row="1"
                                            Grid.Column="1"
                                            Height="150"
                                            Margin="0,5,0,5"
                                            ec:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding ResultsDisplacements_Cases_Selected}"
                                            ItemsSource="{Binding ResultsDisplacements_Cases_ViewItems}"
                                            SelectionMode="Extended" />
                                        <TextBlock
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            Margin="0,0,5,0"
                                            VerticalAlignment="Center"
                                            Text="Groups:"
                                            TextAlignment="Right" />
                                        <ListBox
                                            Grid.Row="2"
                                            Grid.Column="1"
                                            Height="150"
                                            Margin="0,0,0,5"
                                            ec:MultiSelectorBehaviours.SynchronizedSelectedItems="{Binding ResultsDisplacements_Groups_Selected}"
                                            ItemsSource="{Binding ResultsDisplacements_Groups_ViewItems}"
                                            SelectionMode="Extended" />
                                        <Border
                                            Grid.Row="3"
                                            Grid.ColumnSpan="100"
                                            Margin="3"
                                            BorderBrush="DeepSkyBlue"
                                            BorderThickness="1,1,1,1"
                                            CornerRadius="5">
                                            <StackPanel Orientation="Vertical">
                                                <TextBlock
                                                    Margin="5"
                                                    Style="{DynamicResource Explanation_TextBlock}"
                                                    TextWrapping="Wrap">
                                                    <Run>Duplicate lines for joints whose names may be split by the separator. It will create a new line for each split joint name and remove the merged line.</Run>
                                                </TextBlock>
                                                <Grid Margin="5,0,5,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <CheckBox
                                                        Grid.Column="0"
                                                        Margin="0,1,0,0"
                                                        Content="Duplicate and Split Lines"
                                                        IsChecked="{Binding DuplicateAndSplit_IsChecked}" />
                                                    <TextBox
                                                        Grid.Column="1"
                                                        Margin="25,0,5,0"
                                                        HorizontalAlignment="Stretch"
                                                        Text="{Binding DuplicateAndSplit_SeparatorText}"
                                                        ToolTip="Separator" />
                                                </Grid>
                                            </StackPanel>
                                        </Border>
                                        <Button
                                            Grid.Row="4"
                                            Grid.ColumnSpan="100"
                                            Margin="50,5"
                                            Command="{Binding GetResultDisplacementCommand}"
                                            Content="Get Results" />
                                    </Grid>
                                </GroupBox>
                                <GroupBox Margin="3,0,3,3" Header="Support Falls">
                                    <StackPanel>
                                        <TextBlock
                                            Margin="5"
                                            Style="{DynamicResource Explanation_TextBlock}"
                                            Text="Gets the amount that each support falls when removed." />
                                        <Button
                                            Margin="50,0,50,5"
                                            Command="{Binding GetResultDisplacementSupportFall}"
                                            Content="Get Support Falls" />
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </GroupBox>
                        <StackPanel Grid.Column="1" Orientation="Vertical">
                            <GroupBox
                                Margin="5"
                                Header="Survey"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Orientation="Vertical">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock
                                            Margin="5"
                                            Text="Areas:"
                                            TextAlignment="Right" />
                                        <TextBox
                                            Grid.Column="1"
                                            Margin="5"
                                            Text="{Binding Areas}"
                                            ToolTip="Separate with underline _ for more." />
                                        <RadioButton
                                            Grid.Row="1"
                                            Margin="5"
                                            HorizontalAlignment="Center"
                                            Content="Survey Points"
                                            GroupName="SurveyWorkOrSurveyPoint"
                                            IsChecked="{Binding SurveyRadio_IsChecked}" />
                                        <RadioButton
                                            Grid.Row="1"
                                            Grid.Column="1"
                                            Margin="5"
                                            HorizontalAlignment="Center"
                                            Content="Work Points"
                                            GroupName="SurveyWorkOrSurveyPoint"
                                            IsChecked="{Binding WorkRadio_IsChecked}" />
                                    </Grid>
                                    <Button
                                        Margin="5"
                                        Command="{Binding SurveyReadPointsCommand}"
                                        Content="Insert Points From Excel" />
                                    <Button
                                        Margin="5"
                                        Command="{Binding SurveyLinkToCanopyCommand}"
                                        Content="Link Points to Canopy" />
                                    <Button
                                        Margin="5"
                                        Command="{Binding SurveyAddFixedSupportWithDisplacementsCommand}"
                                        Content="Add Movements" />
                                </StackPanel>
                            </GroupBox>
                            <GroupBox
                                Margin="5"
                                Header="Solver - Match Position for DEAD case"
                                Style="{DynamicResource Blue_GroupBox}">
                                <StackPanel Margin="5" Orientation="Vertical">
                                    <TextBlock HorizontalAlignment="Center" Text="Messages" />
                                    <Border Style="{DynamicResource LightBlue_Border}">
                                        <TextBox
                                            Height="300"
                                            Margin="3"
                                            BorderThickness="0"
                                            IsReadOnly="True"
                                            Text="{Binding DeadMatchSolverMessages}" />
                                    </Border>
                                    <TextBlock
                                        Margin="5"
                                        HorizontalAlignment="Center"
                                        Foreground="DarkSlateBlue"
                                        Text="The *target* model must be open." />
                                    <Button
                                        Margin="50,0"
                                        Command="{Binding SolverMatchDEADCasePositionCommand}"
                                        Content="Start Solver" />
                                </StackPanel>
                            </GroupBox>
                        </StackPanel>
                    </Grid>
                </TabItem>
            </TabControl>
            <e:BusyOverlay x:Name="BusyOverlay" Visibility="Collapsed" />
            <e:MessageOverlay x:Name="MessageOverlay" Visibility="Collapsed" />
        </Grid>
    </DockPanel>
</Window>